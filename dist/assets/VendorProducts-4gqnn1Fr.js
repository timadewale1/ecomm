import{j as e,R as s,c7 as t,r as n,G as a,e as i,O as o,c4 as c,a9 as l,_ as r,H as d,b_ as u,w as m,D as x,E as p,I as h,as as f,Q as b,aS as j,c1 as y,W as g,u as N,s as v,aq as w,cg as k,au as D,ch as C,X as P,ci as S,cj as O,h as F}from"./index-B6_tP4YQ.js";import{r as T,M as A,s as I,t as R,u as $,v as B}from"./index-BZTi0IwX.js";import{M as E,A as U}from"./AddProducts--9kZiUYz.js";import{a as q}from"./index-CkQT2Z8i.js";import{$ as M}from"./module-rdBSHQ9l.js";import{c as W,a as Q}from"./index-AmrmWShL.js";import{g as z}from"./index-C-KPEfQB.js";import{i as V,g as Y}from"./index-BRiOgcip.js";import{d as G,a as L,L as _}from"./index-Czi2OGzl.js";import{S as H}from"./SEO-CG8nsGhn.js";import{h as X,i as J}from"./index-DOHX6TJd.js";import{M as K}from"./index-c29tLOqg.js";import{m as Z}from"./motion-nj0T3Q6E.js";import"./index-Bx5UHif0.js";import"./index-BaqZIR9i.js";import"./index-DfGOTzdC.js";import"./react-select.esm-RpmWxz1_.js";import"./setPrototypeOf-CeEI3KLI.js";import"./emotion-unitless.esm-sScrWPmR.js";import"./inheritsLoose-HiINKdoJ.js";import"./Transition-EapTcxBc.js";import"./index-DPVG87FS.js";import"./index-Bo5izuxS.js";import"./index-C-2PV_nF.js";import"./producttype-CB1j3xpa.js";import"./warning-DM8AoHwU.js";const ee=({isOpen:n,title:a,icon:i,message:o,onClose:c,onConfirm:l,loading:r})=>n?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50 confirmation",children:e.jsxs("div",{className:"space-y-4 flex flex-col justify-center bg-white  px-4 py-2 rounded-xl shadow-lg w-80 h-48",children:[e.jsxs("div",{className:"flex flex-col items-center text-center space-y-2",children:[e.jsx("h2",{className:"text-sm text-customRichBrown",children:a}),e.jsx("p",{className:"text-[10px] text-customRichBrown",children:o})]}),e.jsxs("div",{className:" w-full h-24 px-3 py-1 flex flex-col items-center rounded-2xl bg-customSoftGray space-y-2",children:[e.jsxs("div",{className:"w-full items-center text-red-600 text-sm flex justify-between py-2 focus:outline-none cursor-pointer",onClick:l,children:[a,r?e.jsx(s,{className:"w-4 h-4",animationData:t,loop:!0,autoplay:!0}):e.jsx("div",{children:i})]}),e.jsx("hr",{className:"w-full text-slate-800"}),e.jsxs("div",{className:"w-full items-center text-sm flex justify-between py-2 cursor-pointer",onClick:c,children:["Cancel",e.jsx(T,{className:"w-4 h-4"})]})]})]})}):null,se=({isOpen:s,onClose:t,children:i,onDel:o})=>{const c=n.useRef(null);return n.useEffect((()=>{s&&z.fromTo(c.current,{opacity:0,y:810},{opacity:1,y:0,duration:1,ease:"power2.out"})}),[s]),s?e.jsx("div",{className:"fixed inset-0 flex rounded-t-lg flex-col items-center justify-center w-full bg-gray-300 bg-opacity-70 modal",children:e.jsxs("div",{ref:c,className:"bg-white rounded-t-lg mx-1 px-2 py-4 flex flex-col items-center w-full md:w-3/4 lg:w-1/2 max-h-screen overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between w-full mb-2",children:[e.jsx(a,{className:"text-3xl cursor-pointer",onClick:t}),e.jsx("h2",{className:"text-xl font-opensans text-center font-semibold text-black",children:"Product Details"}),e.jsx("div",{}),e.jsx("button",{onClick:o,children:e.jsx(V,{className:"h-8 w-8 p-1 text-customOrange"})})]}),e.jsx("div",{className:"w-full p-2",children:i})]})}):null},te=({itemId:s,initialIsOn:t,onColor:a="bg-customOrange",offColor:m="bg-gray-300",vendorId:x,name:p})=>{const[h,f]=n.useState(t);n.useEffect((()=>{const e=i(o,"products",s),t=c(e,(e=>{e.exists()&&f(e.data().published)}));return()=>t()}),[s]);const b=async(e,s,t)=>{try{const n=d(o,"vendors",x,"activityNotes");await u(n,{title:e,type:t,note:s,timestamp:new Date})}catch(n){r.error("Error adding activity note: "+n.message)}};return e.jsx("div",{className:`w-11 h-5 flex items-center rounded-full p-1 cursor-pointer ${h?`${a} bg-opacity-5`:m} transition-colors duration-300 ease-in-out`,onClick:async()=>{const e=!h;f(e);const t=i(o,"products",s);try{await l(t,{published:e,isFeatured:!1}),r.success(h?"Product drafted successfully.":"Product published successfully."),h?await b("Drafted Product 📂",`You've hidden ${p}! Customers can not see or order this product while it is still drafted.`,"Product Update"):await b("Published Product ✨",`You've made ${p} a visible product in your store! This will be part of the first products customers see in your store.`,"Product Update")}catch(n){f(!e)}},children:e.jsx("div",{className:`h-5 w-5 ${h?a:"bg-white"} rounded-full shadow-md transform ${h?"translate-x-5":""} transition-transform duration-300 ease-in-out`})})};K.setAppElement("#root");const ne=({isOpen:s,onRequestClose:t,product:a})=>{var c;const[y,g]=n.useState([]),[N,v]=n.useState(null),[w,k]=n.useState(""),[D,C]=n.useState(""),[P,S]=n.useState(""),[O,F]=n.useState(""),[T,I]=n.useState(!1),[R,$]=n.useState("monetary"),[B,E]=n.useState(!1),[U,q]=n.useState(""),[W,Q]=n.useState(!1),[z,V]=n.useState(!1),L=()=>Q(!1);n.useEffect((()=>{(async()=>{try{const e=x(d(o,"inAppDiscounts"),p("isActive","==",!0)),s=await h(e),t=[];s.forEach((e=>{t.push({id:e.id,...e.data()})})),t.push({id:"personal",name:"Run Personal Discount"}),g(t),t.length>0&&(v(t[0]),F(`inApp-${t[0].id}`))}catch(e){}})()}),[]),n.useEffect((()=>{if(!a)return;let e=a.price||0;const s=parseFloat(e),t=parseFloat(w);if(!isNaN(s)&&!isNaN(t)&&s>0&&t<s){const e=s-t,n=Math.round(e/s*100);C(e.toFixed(2)),S(n)}else C(""),S("")}),[a,w]);const _=O.startsWith("inApp")||"personal-monetary"===O,H="personal-freebies"===O;let X="";_?""===w.trim()?X="Discount price is required.":parseFloat(w)<300?X="Discount price must be at least 300.":parseFloat(w)>=parseFloat(a.price)&&(X="Discount price must be less than the initial price."):H&&""===U.trim()&&(X="Freebie details are required.");const J=""===X;return e.jsxs(e.Fragment,{children:[e.jsxs(K,{isOpen:s,onRequestClose:t,className:"discount-modal",overlayClassName:"modal-overlay",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 px-2 py-2",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx("h2",{className:"font-opensans text-lg text-customRichBrown font-semibold",children:N&&"personal"!==N.id?"In‑App Discount":"Personal Discount"}),e.jsx(Y,{className:"text-customOrange text-xl ml-2"})]}),e.jsx(A,{className:"text-black text-xl cursor-pointer",onClick:t})]}),e.jsxs("div",{className:"py-4 px-2 overflow-y-auto max-h-[90vh]",children:[e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block text-sm font-medium font-opensans text-customRichBrown",children:"Select a Discount Option"}),e.jsx("button",{className:"bg-white w-full text-left text-sm font-opensans border-gray-100 border-2 px-4 py-2 rounded-lg",onClick:()=>I(!T),children:N?N.name:"Select Discount"}),T&&e.jsx("div",{className:"absolute z-50 bg-white w-full rounded-lg shadow-lg ring-1 ring-black ring-opacity-5 mt-2 p-3",children:y.map((s=>e.jsxs("button",{onClick:()=>{v(s),I(!1),"personal"!==s.id?F(`inApp-${s.id}`):F("personal-monetary")},className:"block w-full text-left text-sm text-black font-opensans px-2 py-1 hover:bg-gray-100 rounded-md",children:[s.name," ",s.startDate&&s.endDate?`(Valid from ${new Date(1e3*s.startDate.seconds).toDateString()} to ${new Date(1e3*s.endDate.seconds).toDateString()})`:""]},s.id)))})]}),N&&"personal"===N.id&&e.jsxs("div",{className:"relative mt-4 flex flex-col ",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("label",{className:"block text-sm font-medium font-opensans text-customRichBrown",children:"Select Personal Discount Type"}),e.jsx("button",{className:"ml-2",onClick:()=>Q(!0),children:e.jsx(G,{className:"w-5 h-5 text-customRichBrown"})})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("button",{className:"bg-white w-full text-left text-sm font-opensans border-gray-100 border-2 px-4 py-2 rounded-lg mt-2",onClick:()=>E(!B),children:"monetary"===R?"Monetary":"Freebies"}),B&&e.jsxs("div",{className:"absolute z-50 bg-white w-full rounded-lg shadow-lg ring-1 ring-black ring-opacity-5 mt-2 p-3",children:[e.jsx("button",{onClick:()=>{$("monetary"),E(!1),F("personal-monetary")},className:"block w-full text-left text-sm text-black font-opensans px-2 py-1 hover:bg-gray-100 rounded-md",children:"Monetary"}),e.jsx("button",{onClick:()=>{$("freebies"),E(!1),F("personal-freebies")},className:"block w-full text-left text-sm text-black font-opensans px-2 py-1 hover:bg-gray-100 rounded-md",children:"Freebies"})]})]})]}),(N&&"personal"!==N.id||N&&"personal"===N.id&&"monetary"===R)&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium font-opensans text-customRichBrown",children:"Initial Price"}),e.jsxs("div",{className:"w-full border-2 rounded-md px-2 py-2 bg-gray-50 font-opensans font-medium text-black text-sm border-gray-100 text-right",children:["₦",null==(c=null==a?void 0:a.price)?void 0:c.toFixed(2)]}),e.jsx("label",{className:"block text-sm font-medium font-opensans text-customRichBrown mt-4",children:"Discount Price"}),e.jsx("input",{type:"text",value:w,onChange:e=>k((e.target.value.replace(/\D/g,"")/100).toFixed(2)),onBlur:()=>{parseFloat(w)<300&&(r.error("Discount price must be at least 300"),k(""))},className:"w-full text-right border-2 font-opensans text-gray-800 border-gray-100 rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-customOrange",placeholder:"0.00"}),e.jsxs("div",{className:"mt-4 flex gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium font-opensans text-customRichBrown",children:"Subtractive Value"}),e.jsxs("div",{className:"w-full border-2 rounded-md px-2 py-2 bg-gray-50 font-opensans font-medium text-black text-sm border-gray-100 text-right",children:["₦",D]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium font-opensans text-customRichBrown",children:"Percentage Cut"}),e.jsxs("div",{className:"w-full border-2 rounded-md px-2 py-2 bg-gray-50 font-opensans font-medium text-black text-sm border-gray-100 text-right",children:[P,"%"]})]})]})]}),N&&"personal"===N.id&&"freebies"===R&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium font-opensans text-customRichBrown",children:"Freebie Details"}),e.jsx("input",{type:"text",value:U,onChange:e=>q(e.target.value),className:"w-full border-2 font-opensans text-gray-800 border-gray-100 rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-customOrange",placeholder:"Enter details (e.g., Buy 1 Get 1 Free, Free Delivery)"})]}),!J&&e.jsx("div",{className:"mt-4",children:e.jsx("p",{className:"text-sm font-opensans text-red-600",children:X})}),e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx("button",{onClick:async()=>{V(!0);try{const e=i(o,"products",a.id),s=i(o,"vendors",a.vendorId),n=d(o,"discounts");let c={};N&&"personal"!==N.id?c={discountType:`inApp-${N.id}`,selectedDiscount:N,initialPrice:parseFloat(a.price),discountPrice:parseFloat(w),subtractiveValue:parseFloat(D),percentageCut:parseFloat(P)}:"personal"===(null==N?void 0:N.id)&&("monetary"===R?c={discountType:"personal-monetary",initialPrice:parseFloat(a.price),discountPrice:parseFloat(w),subtractiveValue:parseFloat(D),percentageCut:parseFloat(P)}:"freebies"===R&&(c={discountType:"personal-freebies",freebieText:U}));const m=i(n),x={vendorId:a.vendorId,type:c.discountType.startsWith("inApp")?"inApp":"personal",isActive:!0,createdAt:f(),...c.discountType.startsWith("personal")&&{discountSubType:"personal-monetary"===c.discountType?"monetary":"freebies"},..."personal-freebies"!==c.discountType&&c.initialPrice&&{initialPrice:c.initialPrice,discountPrice:c.discountPrice,percentageCut:c.percentageCut,subtractiveValue:c.subtractiveValue},..."personal-freebies"===c.discountType&&{freebieText:c.freebieText},...c.selectedDiscount&&{selectedDiscountId:c.selectedDiscount.id,selectedDiscountName:c.selectedDiscount.name}};await b(m,x),await l(s,{discountIds:j(m.id)});const p={discount:c,discountId:m.id};"freebies"!==R&&c.discountPrice&&(p.price=c.discountPrice),await l(e,p),await(async(e,s,t)=>{const n=d(o,"vendors",a.vendorId,"activityNotes"),i={title:e,type:t,timestamp:new Date,note:s};try{await u(n,i)}catch(c){}})("Running a Discount 🏷",`You've applied a ${c.discountType.startsWith("inApp")?"store-wide":"personal"} discount on ${a.name}. Check your store for more details!`,"Discount Update"),r.success("Discount saved and applied successfully!"),V(!1),t()}catch(e){r.error("Failed to save the discount. Please try again."),V(!1)}},disabled:!J,className:"w-full px-4 py-3 rounded-full font-opensans font-medium text-sm flex justify-center items-center "+(J?"bg-customOrange text-white hover:bg-orange-700":"bg-gray-400 text-gray-200 cursor-not-allowed"),children:z?e.jsx(M,{strokeColor:"white",strokeWidth:"5",animationDuration:"0.75",width:"20",visible:!0}):"Save Discount"})})]})]}),e.jsxs(K,{isOpen:W,onRequestClose:L,className:"modal-content-rider h-auto",overlayClassName:"modal-overlay backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-7 h-7 bg-blue-100 flex justify-center items-center rounded-full",children:e.jsx(m,{className:"text-customRichBrown"})}),e.jsx("h2",{className:"font-opensans text-base font-semibold",children:"Personal Discount Details"})]}),e.jsx(A,{className:"text-xl relative -top-2",onClick:L})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsx("p",{className:"text-xs font-opensans text-black font-medium",children:"Monetary Discount:"}),e.jsx("p",{className:"text-xs font-opensans text-black",children:"With a Monetary Discount, you set an initial price and a discounted price. The system calculates the amount off and the percentage reduction (displayed as a whole number). Ensure that the discount price is at least 300 and less than the initial price."}),e.jsx("p",{className:"text-xs font-opensans text-black font-medium mt-2",children:"Freebies Discount:"}),e.jsx("p",{className:"text-xs font-opensans text-black",children:'When choosing Freebies, no price reduction is applied. Instead, you provide details of the free offer (e.g., "Buy 1 Get 1 Free" or "Free Delivery"). This option is ideal if you wish to offer an incentive without changing the product price.'})]}),e.jsx("div",{className:"flex justify-end mt-2",children:e.jsx("button",{onClick:L,className:"bg-customOrange text-white font-opensans py-2 px-12 rounded-full flex items-center",children:"Close"})})]})]})};K.setAppElement("#root");const ae=({isOpen:s,onRequestClose:t,product:a})=>{const[c,y]=n.useState([]),[g,N]=n.useState(null),[v,w]=n.useState(""),[k,D]=n.useState(""),[C,P]=n.useState(""),[S,O]=n.useState(""),[F,T]=n.useState(!1),[I,R]=n.useState(!1),[$,B]=n.useState("monetary"),[E,U]=n.useState(!1),[q,W]=n.useState(""),[Q,z]=n.useState(!1),[V,L]=n.useState(!1),_=()=>z(!1);n.useEffect((()=>{(async()=>{try{const e=x(d(o,"inAppDiscounts"),p("isActive","==",!0)),s=await h(e),t=[];s.forEach((e=>{t.push({id:e.id,...e.data()})})),t.push({id:"personal",name:"Run Personal Discount"}),y(t),t.length>0&&(N(t[0]),O(`inApp-${t[0].id}`))}catch(e){}})()}),[]),n.useEffect((()=>{if(!a)return;let e=a.price||0;const s=parseFloat(e),t=parseFloat(v);if(!isNaN(s)&&!isNaN(t)&&s>0&&t<s){const e=s-t,n=Math.round(e/s*100);D(e.toFixed(2)),P(n)}else D(""),P("")}),[a,v]);const H=S.startsWith("inApp")||"personal-monetary"===S,J="personal-freebies"===S;let Z="";H?""===v.trim()?Z="Discount price is required.":parseFloat(v)<300?Z="Discount price must be at least 300.":parseFloat(v)>=parseFloat(a.price)&&(Z="Discount price must be less than the initial price."):J&&""===q.trim()&&(Z="Freebie details are required.");const se=""===Z;return e.jsxs(e.Fragment,{children:[e.jsxs(K,{isOpen:s,onRequestClose:t,className:"discount-modal",overlayClassName:"modal-overlay",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 px-2 py-2",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx("h2",{className:"font-opensans text-lg text-customRichBrown font-semibold",children:g&&"personal"!==g.id?"In‑App Discount":"Personal Discount"}),e.jsx(Y,{className:"text-customOrange text-xl ml-2"})]}),e.jsx(A,{className:"text-black text-xl cursor-pointer",onClick:t})]}),e.jsxs("div",{className:"py-4 px-2 overflow-y-auto max-h-[90vh]",children:[e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block text-sm font-medium font-opensans text-customRichBrown",children:"Select a Discount Option"}),e.jsx("button",{className:"bg-white w-full text-left text-sm font-opensans border-gray-100 border-2 px-4 py-2 rounded-lg",onClick:()=>T(!F),children:g?g.name:"Select Discount"}),F&&e.jsx("div",{className:"absolute z-50 bg-white w-full rounded-lg shadow-lg ring-1 ring-black ring-opacity-5 mt-2 p-3",children:c.map((s=>e.jsxs("button",{onClick:()=>{N(s),T(!1),"personal"!==s.id?O(`inApp-${s.id}`):O("personal-monetary")},className:"block w-full text-left text-sm text-black font-opensans px-2 py-1 hover:bg-gray-100 rounded-md",children:[s.name," ",s.startDate&&s.endDate?`(Valid from ${new Date(1e3*s.startDate.seconds).toDateString()} to ${new Date(1e3*s.endDate.seconds).toDateString()})`:""]},s.id)))})]}),g&&"personal"===g.id&&e.jsxs("div",{className:"relative mt-4 flex flex-col ",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("label",{className:"block text-sm font-medium font-opensans text-customRichBrown",children:"Select Personal Discount Type"}),e.jsx("button",{className:"ml-2",onClick:()=>z(!0),children:e.jsx(G,{className:"w-5 h-5 text-customRichBrown"})})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("button",{className:"bg-white w-full text-left text-sm font-opensans border-gray-100 border-2 px-4 py-2 rounded-lg mt-2",onClick:()=>U(!E),children:"monetary"===$?"Monetary":"Freebies"}),E&&e.jsxs("div",{className:"absolute z-50 bg-white w-full rounded-lg shadow-lg ring-1 ring-black ring-opacity-5 mt-2 p-3",children:[e.jsx("button",{onClick:()=>{B("monetary"),U(!1),O("personal-monetary")},className:"block w-full text-left text-sm text-black font-opensans px-2 py-1 hover:bg-gray-100 rounded-md",children:"Monetary"}),e.jsx("button",{onClick:()=>{B("freebies"),U(!1),O("personal-freebies")},className:"block w-full text-left text-sm text-black font-opensans px-2 py-1 hover:bg-gray-100 rounded-md",children:"Freebies"})]})]})]}),(g&&"personal"!==g.id||g&&"personal"===g.id&&"monetary"===$)&&e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"mt-4 flex gap-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium font-opensans text-customRichBrown",children:"Percentage Cut"}),e.jsxs("div",{className:"w-full border-2 rounded-md px-2 py-2 bg-gray-50 font-opensans font-medium text-black text-sm border-gray-100 text-right",children:[C,"%"]})]})})}),g&&"personal"===g.id&&"freebies"===$&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium font-opensans text-customRichBrown",children:"Freebie Details"}),e.jsx("input",{type:"text",value:q,onChange:e=>W(e.target.value),className:"w-full border-2 font-opensans text-gray-800 border-gray-100 rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-customOrange",placeholder:"Enter details (e.g., Buy 1 Get 1 Free, Free Delivery)"})]}),!se&&e.jsx("div",{className:"mt-4",children:e.jsx("p",{className:"text-sm font-opensans text-red-600",children:Z})}),e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx("button",{onClick:async()=>{L(!0);try{const e=i(o,"products",a.id),s=i(o,"vendors",a.vendorId),n=d(o,"discounts");let c={};g&&"personal"!==g.id?c={discountType:`inApp-${g.id}`,selectedDiscount:g,initialPrice:parseFloat(a.price),discountPrice:parseFloat(v),subtractiveValue:parseFloat(k),percentageCut:parseFloat(C)}:"personal"===(null==g?void 0:g.id)&&("monetary"===$?c={discountType:"personal-monetary",initialPrice:parseFloat(a.price),discountPrice:parseFloat(v),subtractiveValue:parseFloat(k),percentageCut:parseFloat(C)}:"freebies"===$&&(c={discountType:"personal-freebies",freebieText:q}));const m=i(n),x={vendorId:a.vendorId,type:c.discountType.startsWith("inApp")?"inApp":"personal",isActive:!0,createdAt:f(),...c.discountType.startsWith("personal")&&{discountSubType:"personal-monetary"===c.discountType?"monetary":"freebies"},..."personal-freebies"!==c.discountType&&c.initialPrice&&{initialPrice:c.initialPrice,discountPrice:c.discountPrice,percentageCut:c.percentageCut,subtractiveValue:c.subtractiveValue},..."personal-freebies"===c.discountType&&{freebieText:c.freebieText},...c.selectedDiscount&&{selectedDiscountId:c.selectedDiscount.id,selectedDiscountName:c.selectedDiscount.name}};await b(m,x),await l(s,{discountIds:j(m.id)});const p={discount:c,discountId:m.id};"freebies"!==$&&c.discountPrice&&(p.price=c.discountPrice),await l(e,p),await(async(e,s,t)=>{const n=d(o,"vendors",a.vendorId,"activityNotes"),i={title:e,type:t,timestamp:new Date,note:s};try{await u(n,i)}catch(c){}})("Running a Discount 🏷",`You've applied a ${c.discountType.startsWith("inApp")?"store-wide":"personal"} discount on ${a.name}. Check your store for more details!`,"Discount Update"),r.success("Discount saved and applied successfully!"),L(!1),t()}catch(e){r.error("Failed to save the discount. Please try again."),L(!1)}},disabled:!se,className:"w-full px-4 py-3 rounded-full font-opensans font-medium text-sm flex justify-center items-center "+(se?"bg-customOrange text-white hover:bg-orange-700":"bg-gray-400 text-gray-200 cursor-not-allowed"),children:V?e.jsx(M,{strokeColor:"white",strokeWidth:"5",animationDuration:"0.75",width:"20",visible:!0}):"Save Discount"})})]})]}),e.jsxs(K,{isOpen:Q,onRequestClose:_,className:"modal-content-rider h-auto",overlayClassName:"modal-overlay backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-7 h-7 bg-blue-100 flex justify-center items-center rounded-full",children:e.jsx(m,{className:"text-customRichBrown"})}),e.jsx("h2",{className:"font-opensans text-base font-semibold",children:"Personal Discount Details"})]}),e.jsx(A,{className:"text-xl relative -top-2",onClick:_})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsx("p",{className:"text-xs font-opensans text-black font-medium",children:"Monetary Discount:"}),e.jsx("p",{className:"text-xs font-opensans text-black",children:"With a Monetary Discount, you set an initial price and a discounted price. The system calculates the amount off and the percentage reduction (displayed as a whole number). Ensure that the discount price is at least 300 and less than the initial price."}),e.jsx("p",{className:"text-xs font-opensans text-black font-medium mt-2",children:"Freebies Discount:"}),e.jsx("p",{className:"text-xs font-opensans text-black",children:'When choosing Freebies, no price reduction is applied. Instead, you provide details of the free offer (e.g., "Buy 1 Get 1 Free" or "Free Delivery"). This option is ideal if you wish to offer an incentive without changing the product price.'})]}),e.jsx("div",{className:"flex justify-end mt-2",children:e.jsx("button",{onClick:_,className:"bg-customOrange text-white font-opensans py-2 px-12 rounded-full flex items-center",children:"Close"})})]}),e.jsx("div",{children:e.jsx(ee,{isOpen:I,onClose:()=>R(!1),message:"Are you sure you want to add this discount to the selected product(s)?",icon:e.jsx(X,{className:"w-4 h-4"}),title:"Add Discount"})})]})},ie=()=>{const[s,t]=n.useState([]),[a,r]=n.useState(!0),[m,h]=n.useState(null),[f,b]=n.useState("Active"),[j,T]=n.useState(null),[A,z]=n.useState(0),[Y,G]=n.useState(!1),[K,ie]=n.useState(!1),[oe,ce]=n.useState(!1),[le,re]=n.useState(!1),[de,ue]=n.useState(!1),[me,xe]=n.useState(""),[pe,he]=n.useState(!1),[fe,be]=n.useState({}),[je,ye]=n.useState(!1),[ge,Ne]=n.useState(!1),[ve,we]=n.useState(!1),[ke,De]=n.useState(!1),[Ce,Pe]=n.useState(!1),[Se,Oe]=n.useState(!1),[Fe,Te]=n.useState(!1),{vendorData:Ae}=n.useContext(y),[Ie,Re]=n.useState([]),[$e,Be]=n.useState(0),[Ee,Ue]=n.useState(null),[qe,Me]=n.useState(!1),[We,Qe]=n.useState(!1),ze=g(),Ve=N();n.useEffect((()=>{let e;if(j&&Y){const s=i(o,"products",j.id);e=c(s,(e=>{e.exists()&&T({id:e.id,...e.data()})}))}return()=>{e&&e()}}),[j,Y]),n.useEffect((()=>{const e=v(ze,(e=>{e?(h(e.uid),Ye(e.uid)):(P.error("Unauthorized access or no user is signed in."),r(!1),Ve("/login"))}));return()=>e()}),[ze,Ve]),n.useEffect((()=>{}),[]),n.useEffect((()=>{if(!m)return;let e;return(async()=>{e=await Ye(m)})(),Ge(),()=>{e&&e()}}),[m]);const Ye=e=>{De(!0);const s=x(d(o,"products"),p("vendorId","==",e),p("isDeleted","==",!1));return c(s,(async e=>{const s=[],n=S(o);e.docs.forEach((e=>{const t={id:e.id,...e.data()};0===t.stockQuantity&&t.isFeatured&&(n.update(e.ref,{isFeatured:!1}),t.isFeatured=!1),s.push(t)})),n.isEmpty||await n.commit(),t(s),z(s.length),De(!1)}))},Ge=()=>{const e=x(d(o,"products"),p("isFeatured","==",!0),p("vendorId","==",m));c(e,(e=>{Be(e.size)}))};n.useEffect((()=>{if(j){const e=i(o,"products",j.id),s=c(e,(e=>{e.exists()&&we(e.data().published)}));return()=>s()}}),[j,m]);const Le=()=>{Re([]),Me((e=>!e)),Qe(!1),Ue(null),Pe(!1)},_e=()=>{Pe(!0),Re([])},He=e=>{Re((s=>s.includes(e)?s.filter((s=>s!==e)):[...s,e]))},Xe=()=>{if(0===Ie.length)return!1;const e=s.filter((e=>Ie.includes(e.id))),t=e.every((e=>e.published)),n=e.every((e=>!e.published));return"Active"===f&&t||"Drafts"===f&&n},Je=async()=>{Ne(!0);try{for(const e of Ie){const s=i(o,"products",e);await l(s,{published:"Drafts"===f,isFeatured:!1})}P.success("Drafts"===f?"Selected products published successfully.":"Selected products unpublished successfully."),Re([]),Me((e=>!e)),Qe(!1),Ue(null),xe(""),Pe(!1),ce(!1)}catch(e){P.error("Error changing publish state: "+e.message)}finally{Ne(!1)}},Ke=()=>{G(!1),ie(!1),T(null),pe&&(he(!1),be({}))},[Ze,es]=n.useState("null"),ss=`https://mx.shopmythrift.store/product/${Ze||"null"}?shared=true`,[ts,ns]=n.useState(!1),as=async(e,s,t)=>{try{const n=d(o,"vendors",m,"activityNotes");await u(n,{title:e,type:t,note:s,timestamp:new Date})}catch(n){P.error("Error adding activity note: "+n.message)}},is=()=>{he((e=>!e)),be({})},os=()=>Object.values(fe).some((e=>(null==e?void 0:e.quantity)&&parseInt(e.quantity,10)>0)),cs=(e,s,t)=>{be((n=>({...n,[s]:{...n[s],[e]:t}})))},ls=(e,s=20)=>e?e.length<=s?e:e.substring(0,s)+"...":"",rs=e=>e.reduce(((e,s)=>(e[s.color]||(e[s.color]=[]),e[s.color].push(s),e)),{}),ds=s.filter((e=>0===e.stockQuantity)).length,us=s.filter((e=>"Active"===f?"addDisc"===Ee?e.published&&e.stockQuantity>0&&!e.discountId&&!e.discount:"remDisc"===Ee?e.published&&e.stockQuantity>0&&e.discountId&&e.discount:e.published&&e.stockQuantity>0:"OOS"===f?"addDisc"===Ee?0===e.stockQuantity&&!e.discountId&&!e.discount:"remDisc"===Ee?0===e.stockQuantity&&e.discountId&&e.discount:0===e.stockQuantity:"addDisc"===Ee?!e.published&&!e.discountId&&!e.discount:"remDisc"===Ee?!e.published&&e.discountId&&e.discount:!e.published)).sort(((e,s)=>e.isFeatured===s.isFeatured?0:e.isFeatured?-1:1)),ms=e=>e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2});return e.jsxs(e.Fragment,{children:[e.jsx(H,{title:"Your Store - My Thrift",description:"Manage your products on My Thrift",url:"https://www.shopmythrift.store/vendor-products"}),e.jsxs("div",{className:"mb-40 mx-3 my-7 flex flex-col justify-center space-y-5 font-opensans ",children:[e.jsx(w,{}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("div",{className:"relative flex justify-center items-center",children:[qe&&!We&&!Ce&&e.jsxs("div",{className:"absolute top-10 right-[28px] items-center flex flex-col justify-center  w-[300px] h-[104px] p-4 space-y-1 bg-white border shadow-lg rounded-2xl z-50 text-[16px]",children:[e.jsx("div",{className:"flex justify-between w-full items-center py-2 cursor-pointer",onClick:()=>{Ue("manage"),_e()},children:e.jsx("p",{className:"font-semibold text-black",children:"Product Management"})}),e.jsx("hr",{className:"w-[250px]"}),e.jsx("div",{className:"flex relative justify-between w-full items-center py-2 cursor-pointer",onClick:()=>{Qe(!0)},children:e.jsx("p",{className:"font-semibold text-black",children:"Manage Discounts"})})]}),We&&!Ce&&e.jsx("div",{className:"absolute top-10 right-[28px] items-center flex flex-col justify-center  w-[300px] h-[52px] p-4 space-y-1 bg-white border shadow-lg rounded-2xl z-50 text-[16px]",children:e.jsxs("div",{className:"flex relative justify-between w-full items-center py-2 cursor-pointer",onClick:()=>{Ue("remDisc"),_e()},children:[e.jsx("p",{className:"font-semibold text-black",children:"Remove Discounts"}),e.jsx(J,{className:"text-2xl"})]})}),Ce&&Ie.length<1&&e.jsxs("div",{className:"absolute top-10 right-[28px] items-center flex justify-between  w-[300px] h-[52px] p-4 bg-white border shadow-lg rounded-2xl z-50 text-[16px]",children:[e.jsx("p",{className:"font-semibold text-black",children:"Select a Product"}),e.jsx(k,{})]}),qe?e.jsx("p",{className:"cursor-pointer text-[16px] my-2.5",onClick:Le,children:"Cancel"}):e.jsx("div",{className:"cursor-pointer relative rounded-full w-11 h-11 bg-customOrange bg-opacity-10 flex justify-center items-center",onClick:Le,children:e.jsx(W,{className:"w-6 h-6"})})]})}),e.jsxs("div",{className:"relative bg-customDeepOrange w-full h-c120 rounded-2xl flex flex-col justify-center px-4 py-2",children:[e.jsx("div",{className:"absolute top-0 right-0",children:e.jsx("img",{src:"./Vector.png",alt:"",className:"w-16 h-24"})}),e.jsx("div",{className:"absolute bottom-0 left-0",children:e.jsx("img",{src:"./Vector2.png",alt:"",className:"w-16 h-16"})}),e.jsxs("div",{className:"flex flex-col justify-center items-center space-y-3",children:[e.jsxs("p",{className:"text-white text-lg",children:["Active"===f?f:"Drafts"===f?"Drafted":"Out of Stock"," ","Products"]}),e.jsx("p",{className:"text-white text-3xl font-bold",children:ke?e.jsx(D,{width:38,height:28,className:"opacity-50"}):us.length})]})]}),e.jsxs("div",{className:"flex justify-center space-x-5 items-center",children:[e.jsxs("div",{className:"flex flex-col justify-center items-center space-y-3",children:[e.jsx("p",{className:"text-sm cursor-pointer "+("Active"===f?"text-customOrange":"text-black"),onClick:()=>b("Active"),children:"Active"}),e.jsx("div",{className:"h-1",children:"Active"===f&&e.jsx("hr",{className:"text-customOrange opacity-40  w-11"})})]}),e.jsxs("div",{className:"flex flex-col justify-center items-center space-y-3",children:[e.jsxs("p",{className:"text-sm cursor-pointer flex space-x-1 "+("OOS"===f?"text-customOrange":"text-black"),onClick:()=>b("OOS"),children:["Out of Stock"," ",ds>0&&e.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full flex items-center justify-center w-5 h-5 animate-ping",children:ds})]}),e.jsx("div",{className:"h-1",children:"OOS"===f&&e.jsx("hr",{className:"text-customOrange opacity-40  w-11"})})]}),e.jsxs("div",{className:"flex flex-col justify-center items-center space-y-3",children:[e.jsx("p",{className:" text-sm cursor-pointer "+("Drafts"===f?"text-customOrange":"text-black"),onClick:()=>b("Drafts"),children:"Drafts"}),e.jsx("div",{className:"h-1",children:"Drafts"===f&&e.jsx("hr",{className:"text-customOrange opacity-40  w-11"})})]})]}),"Active"===f&&(()=>{const t=s.filter((e=>e.discount&&!e.isDeleted&&e.published));return t.length>0&&e.jsx("div",{className:"px-2 py-1 bg-green-50 rounded-lg -translate-y-2 shadow",children:e.jsxs("p",{className:"text-xs font-semibold font-opensans text-green-600",children:["Discount Campaign Active: You are currently offering discounts on ",t.length," product",t.length>1?"s":"",". Your followers will be notified🎊"]})})})(),e.jsx("div",{className:` ${us<1&&" justify-center items-center text-center"} ${us.length>0&&!ke&&"grid grid-cols-2 gap-4"}`,children:us&&us.length>0&&!ke?us.map((s=>{var n,a;const c=null==(n=s.subProducts)?void 0:n.some((e=>0===e.stock)),r=null==(a=s.variants)?void 0:a.some((e=>0===e.stock));return e.jsx("div",{className:"cursor-pointer",onClick:e=>Ce?He(s.id):(e=>{T(e),es(e.id),G(!0)})(s),children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("div",{className:"relative w-44 h-44 rounded-xl bg-customSoftGray",children:[(c||r)&&"OOS"!==f&&e.jsx("div",{className:"absolute bottom-2 right-2 w-4 h-4 bg-customOrange rounded-full animate-ping"}),Ce?e.jsx("div",{onClick:e=>{e.stopPropagation(),He(s.id)},className:"absolute top-2 left-2",children:Ie.includes(s.id)?e.jsx(q,{className:"text-customOrange w-6 h-6"}):e.jsx(C,{className:"text-customOrange w-6 h-6"})}):"Active"===f&&(!s.isFeatured&&$e<4||s.isFeatured)&&e.jsx("div",{onClick:e=>{e.stopPropagation(),(async e=>{const s=(new Date).getTime();if(e.isFeatured){const t=e.pinnedAt||0;if(s-t<432e5)return void P.error("You cannot unfeature a product within 12 hours of featuring it.")}try{const n=i(o,"products",e.id),a=!e.isFeatured;await l(n,{isFeatured:a,...a&&{pinnedAt:s}}),t((t=>t.map((t=>t.id===e.id?{...t,isFeatured:a,pinnedAt:a?s:null}:t)))),Be((e=>a?e+1:e-1)),a?(await as("Product Starred ⭐",`You've made ${e.name} one of your featured products! This will be part of the first products customers see in your store.`,"Product Update"),P.success("Product featured successfully.")):P.success("Product unfeatured successfully."),Ge()}catch(n){P.error("Error Featuring/unfeaturing product: "+n.message)}})(s)},className:"absolute top-2 right-2 bg-white rounded-full p-1",children:s.isFeatured?e.jsx(I,{className:"text-customOrange  w-5 h-5"}):e.jsx(R,{className:"text-customOrange  w-5 h-5"})}),s.discount&&!Ce&&e.jsx("div",{className:"absolute top-2 left-2 flex items-center",children:s.discount.discountType.startsWith("personal-freebies")?e.jsx("div",{className:"bg-customPink text-customOrange text-sm px-2 py-1 font-medium font-opensans rounded-md",children:ls(s.discount.freebieText)}):e.jsxs("div",{className:"bg-customPink font-opensans text-customOrange text-sm font-medium px-2 py-1 rounded-md",children:["-",s.discount.percentageCut,"%"]})}),e.jsx("img",{src:s.coverImageUrl,alt:s.name,className:"w-full h-full object-cover rounded-xl bg-customSoftGray"})]}),e.jsxs("div",{className:"flex",children:[e.jsx("p",{className:"text-xs font-semibold font-opensans text-black truncate w-32",children:s.name})," ",e.jsx("p",{className:"text-xs font-semibold font-opensans text-black truncate w-9"})," "]}),e.jsxs("div",{className:" "+(s.published?"space-y-2":"flex space-x-4"),children:[e.jsxs("p",{className:"text-xs font-semibold font-opensans text-black",children:["Total Stock: ",s.stockQuantity]}),e.jsxs("p",{className:"text-xs font-medium font-opensans text-black",children:["₦",ms(s.price)]})]}),!s.published&&e.jsx("p",{className:"text-xs font-semibold font-opensans text-customOrange",children:"Unpublished Product"}),e.jsx("div",{className:"mt-1",children:s.discount&&e.jsx("p",{className:"text-xs font-opensans font-semibold text-customRichBrown",children:s.discount.discountType.startsWith("inApp")?"In‑App Discount":"personal-monetary"===s.discount.discountType?"Personal Monetary Discount":"personal-freebies"===s.discount.discountType?`Freebie: ${ls(s.discount.freebieText)}`:""})})]})},s.id)})):"Active"!==f||ke?"OOS"!==f||ke?ke?e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx(D,{width:176,height:176}),e.jsx(D,{width:120,height:12}),e.jsx(D,{width:105,height:12}),e.jsx(D,{width:70,height:12})]}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx(D,{width:176,height:176}),e.jsx(D,{width:78,height:12}),e.jsx(D,{width:135,height:12}),e.jsx(D,{width:98,height:12})]}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx(D,{width:176,height:176}),e.jsx(D,{width:98,height:12}),e.jsx(D,{width:155,height:12}),e.jsx(D,{width:66,height:12})]}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx(D,{width:176,height:176}),e.jsx(D,{width:78,height:12}),e.jsx(D,{width:135,height:12}),e.jsx(D,{width:98,height:12})]}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx(D,{width:176,height:176}),e.jsx(D,{width:88,height:12}),e.jsx(D,{width:105,height:12}),e.jsx(D,{width:90,height:12})]}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx(D,{width:176,height:176}),e.jsx(D,{width:68,height:12}),e.jsx(D,{width:145,height:12}),e.jsx(D,{width:88,height:12})]}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx(D,{width:176,height:176}),e.jsx(D,{width:70,height:12}),e.jsx(D,{width:115,height:12}),e.jsx(D,{width:67,height:12})]})]}):!ke&&e.jsx("p",{className:"text-xs mt-24 font-opensans",children:"📝 You have no saved draft products yet. Start a new listing and save it as a draft anytime!"}):e.jsx("p",{className:"text-xs font-opensans mt-24",children:"📦 You currently have no items marked as out of stock."}):e.jsx("p",{className:"text-xs font-opensans mt-24",children:"📭 Your store has no active products yet. Upload items to start attracting customers!"})})]}),!Ce&&e.jsx("button",{onClick:()=>{ie(!0)},className:`fixed bottom-24 right-5 flex justify-center items-center ${(null==Ae?void 0:Ae.isApproved)?"bg-customOrange":"bg-customOrange opacity-35 cursor-not-allowed"} text-white rounded-full w-11 h-11 shadow-lg focus:outline-none`,disabled:!(null==Ae?void 0:Ae.isApproved),children:e.jsx("span",{className:"text-3xl",children:e.jsx(Q,{})})}),Ce&&Ie.length>0&&"manage"===Ee?e.jsxs(Z.div,{initial:{y:"100%"},animate:{y:0},exit:{x:"100%"},transition:{type:"spring",stiffness:100,damping:20},className:`fixed bottom-0 z-[1001] flex px-4 ${Xe()?"justify-between":"justify-center"} py-3 bg-white text-white w-full h-[94px] shadow-lg focus:outline-none`,children:[Xe()&&e.jsx("p",{className:"text-lg font-semibold font-opensans text-customRichBrown cursor-pointer",children:"Active"===f?e.jsx("p",{className:"text-lg font-semibold text-customRichBrown",onClick:()=>{xe("unpublish"),ce(!0)},children:"Unpublish"}):e.jsx("p",{className:"text-lg font-semibold font-opensans text-customRichBrown cursor-pointer",onClick:()=>{xe("publish"),ce(!0)},children:"Publish"})}),e.jsx("p",{className:"text-lg font-semibold font-opensans text-customRichBrown mb-4 cursor-pointer",onClick:()=>(xe("bulkDelete"),void ce(!0)),children:"Delete"})]}):Ce&&Ie.length>0&&e.jsx(Z.div,{initial:{y:"100%"},animate:{y:0},exit:{x:"100%"},transition:{type:"spring",stiffness:100,damping:20},className:"fixed bottom-0 z-[1001] flex px-4 justify-center py-3 bg-white text-white w-full h-[94px] shadow-lg focus:outline-none",children:e.jsx("p",{className:"text-lg font-semibold font-opensans text-customRichBrown",children:"addDisc"===Ee?e.jsx("p",{className:"text-lg font-semibold text-customRichBrown cursor-pointer",onClick:()=>{xe("addDiscount"),Te(!0)},children:"Add Discount"}):"remDisc"===Ee&&e.jsx("p",{className:"text-lg font-semibold font-opensans text-customRichBrown cursor-pointer",onClick:()=>{xe("removeDiscount"),ce(!0)},children:"Remove Discount"})})}),j&&e.jsx(se,{isOpen:Y,onClose:Ke,onDel:()=>{xe("delete"),ce(!0)},children:e.jsxs("div",{className:"pb-24 pt-10",children:[j.coverImageUrl&&e.jsx("img",{src:j.coverImageUrl,alt:j.name,className:"w-full h-72 p-1 object-cover bg-customSoftGray rounded-md mb-3"}),e.jsx("div",{className:"flex overflow-x-auto space-x-4 mb-3 snap-x snap-mandatory",children:j.imageUrls&&j.imageUrls.length>0&&j.imageUrls.map(((s,t)=>e.jsx("img",{src:s,alt:`Product ${t+1}`,className:"flex-shrink-0 w-24 h-24 object-cover bg-customSoftGray rounded-md mr-2 snap-center"},t)))}),e.jsxs("div",{className:"flex items-center mb-4 justify-between",children:[e.jsx("p",{className:"text-lg text-black font-opensans font-semibold ",children:j.name}),j.published&&e.jsx("button",{className:"text-white opacity-50 cursor-not-allowed",onClick:async()=>{if(!ts)try{await navigator.clipboard.writeText(ss),ns(!0),setTimeout((()=>ns(!1)),3e3)}catch(e){P.error("Failed to copy!")}},children:ts?e.jsx(_,{className:"text-2xl text-[#28a745]"}):e.jsx(L,{className:"text-2xl text-customOrange"})})]}),e.jsxs("div",{className:"p-3 mb-4 flex flex-col  bg-gray-50  rounded-lg w-full  justify-between space-y-3",children:[e.jsxs("p",{className:"text-black font-semibold  font-opensans text-sm",children:["Price:"," ",e.jsxs("span",{className:"font-normal",children:["₦",ms(j.price)]})]}),e.jsx("hr",{className:"text-customOrange opacity-40   "}),e.jsxs("p",{className:"text-black font-semibold font-opensans text-sm",children:["Product Category:"," ",e.jsx("span",{className:"font-normal",children:j.category})]}),e.jsx("hr",{className:"text-customOrange opacity-40   "}),e.jsxs("p",{className:"text-black font-semibold font-opensans text-sm",children:["Quantity:"," ",e.jsx("span",{className:`${j.stockQuantity<1&&"text-red-500"}`,children:j.stockQuantity>0?j.stockQuantity:"Out of stock"})]}),e.jsx("hr",{className:"text-customOrange opacity-40   "}),e.jsxs("p",{className:"text-black font-semibold  font-opensans text-sm",children:["Product Type:"," ",e.jsx("span",{className:"font-normal",children:j.productType})]}),e.jsx("hr",{className:"text-customOrange opacity-40   "}),e.jsxs("p",{className:"text-black font-semibold font-opensans text-sm",children:["Product Condition:"," ",e.jsx("span",{className:"font-normal",children:j.condition})]}),e.jsx("hr",{className:"text-customOrange opacity-40   "}),e.jsxs("p",{className:"text-black font-semibold font-opensans text-sm",children:["Product Sub-type:"," ",e.jsx("span",{className:"font-normal",children:j.subType})]}),e.jsx("hr",{className:"text-customOrange opacity-40"}),e.jsxs("div",{className:"text-black font-opensans font-semibold text-sm",children:[e.jsx("p",{className:"text-black font-semibold text-sm mb-2",children:"Product Description"})," ",e.jsx("p",{className:"text-black font-normal text-sm leading-6",children:j.description})]}),"Defect:"===j.condition&&e.jsxs(e.Fragment,{children:[" ",e.jsxs("p",{className:"text-red-400 font-opensans font-semibold text-sm",children:["Defect Description:"," ",e.jsx("span",{className:"font-normal",children:j.defectDescription})]}),e.jsx("hr",{className:"text-customOrange opacity-40"})]})]}),j&&!j.discount&&e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"flex justify-end items-center",children:e.jsxs("div",{className:"flex justify-between space-x-1 items-center text-customOrange mb-2 font-medium font-opensans text-base cursor-pointer",onClick:()=>Oe(!0),children:[e.jsx("div",{children:"Start a discount"}),e.jsx(X,{className:"text-2xl"})]})})}),j&&j.discount&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold font-opensans mb-2",children:"Product Discount Details"}),e.jsxs("div",{className:"flex justify-between space-x-1 items-center text-red-600 mb-2 font-medium font-opensans text-base cursor-pointer",onClick:()=>re(!0),children:[e.jsx("div",{children:"Disable"}),e.jsx(J,{className:"text-2xl"})]})]}),j.discount?e.jsxs("div",{className:"flex items-center  justify-between py-1 px-2 bg-green-100 rounded-full",children:[e.jsx("span",{className:"text-sm font-semibold font-opensans text-green-800",children:j.discount.discountType.startsWith("inApp")?"In‑App Discount":"personal-monetary"===j.discount.discountType?"Personal Monetary Discount":"personal-freebies"===j.discount.discountType?`Freebie: ${ls(j.discount.freebieText)}`:""}),e.jsx("span",{className:"bg-green-600 text-white text-xs px-2 py-1 rounded-full",children:"Active"})]}):e.jsxs("div",{className:"flex items-center font-opensans justify-between p-2 bg-gray-200 rounded-full",children:[e.jsx("span",{className:"text-sm font-semibold  text-gray-600",children:"Discount"}),e.jsx("span",{className:"bg-gray-400 text-white text-xs px-2 py-1 rounded-full",children:"Inactive"})]}),(j.discount.discountType.startsWith("inApp")||"personal-monetary"===j.discount.discountType)&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"p-3 mb-4 flex w-full bg-gray-50  rounded-lg mt-3 flex-col justify-between space-y-3",children:[e.jsxs("p",{className:"text-black font-semibold font-opensans text-sm",children:["Initial Price:",e.jsxs("span",{className:"font-normal",children:[" ","₦",ms(j.discount.initialPrice)]})]}),e.jsx("hr",{className:"text-customOrange opacity-40"}),e.jsxs("p",{className:"text-black font-semibold font-opensans text-sm",children:["Discount Price:",e.jsxs("span",{className:"font-normal",children:[" ","₦",ms(j.discount.discountPrice)]})]}),e.jsx("hr",{className:"text-customOrange opacity-40"}),e.jsxs("p",{className:"text-black font-semibold font-opensans text-sm",children:["Percentage:",e.jsxs("span",{className:"font-normal",children:[" ",j.discount.percentageCut,"%"]})]}),e.jsx("hr",{className:"text-customOrange opacity-40"}),e.jsxs("p",{className:"text-black font-semibold font-opensans text-sm",children:["Amount Off:",e.jsxs("span",{className:"font-normal",children:[" ","₦",ms(j.discount.subtractiveValue)]})]})]})})]}),j.variants.slice(1)&&e.jsx("p",{className:"text-lg font-opensans text-black font-semibold mb-2",children:1===j.variants.slice(1).length?"Product Variant":"Product Variants"}),e.jsx("div",{className:"px-2 ",children:e.jsx("div",{className:"flex w-full font-opensans overflow-x-auto space-x-4 snap-x snap-mandatory",children:(s=>{const t=rs(s);return Object.entries(t).map((([s,t],n)=>{const a=t.some((e=>0===e.stock));return e.jsxs("div",{className:"bg-customSoftGray p-3 rounded-lg relative",children:[a&&"OOS"!==f&&e.jsx("div",{className:"absolute top-2 right-2 w-3 h-3 bg-customOrange rounded-full animate-ping"}),e.jsxs("p",{className:"text-black font-semibold text-sm mb-2",children:["Color: ",s]}),e.jsxs("table",{className:"w-custVCard text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"space-x-8",children:[e.jsx("th",{className:"text-black font-semibold text-sm pb-2 border-b border-customOrange border-opacity-40",children:"Size"}),e.jsx("th",{className:"text-black text-right font-semibold text-sm pb-2 border-b border-customOrange border-opacity-40",children:"Quantity"})]})}),e.jsx("tbody",{children:t.map((s=>{var t;const n=`${s.color}-${s.size}`;return e.jsx(e.Fragment,{children:e.jsxs("tr",{className:"space-x-8",children:[e.jsx("td",{className:"py-2 text-sm font-normal border-b border-customOrange border-opacity-40",children:s.size}),e.jsx("td",{className:"py-2 text-sm text-right font-normal border-b border-customOrange border-opacity-40 "+(s.stock<1?"text-red-500":""),children:pe?e.jsx("input",{type:"number",className:"border text-right no-spinner p-1 ml-2 rounded-[10px] focus:outline-customOrange h-6 w-24",value:(null==(t=fe[n])?void 0:t.quantity)||"",onChange:e=>{const s=e.target.value;s>=0?cs("quantity",n,s):P.error("Please enter a non-negative value.")}}):s.stock>0?s.stock:"Out of stock"})]},n)})}))})]})]},n)}))})(j.variants||[])})}),j.subProducts&&e.jsx("p",{className:"text-lg font-opensans text-black font-semibold mb-2",children:(j.subProducts.length,"Sub-Products")}),e.jsx("div",{className:"w-full",children:j.subProducts&&j.subProducts.map((s=>{var t;return e.jsxs("div",{className:"flex items-center relative",children:[0===s.stock&&"OOS"!==f&&e.jsx("div",{className:"absolute bottom-6 right-2 w-3 h-3 bg-customOrange rounded-full animate-ping"}),e.jsx("div",{className:"w-28 h-28",children:e.jsx("img",{src:s.images,alt:"",className:"object-cover bg-customSoftGray rounded-md w-full h-24"})}),e.jsxs("div",{className:"px-3 mb-4 flex w-full flex-col justify-between space-y-3 ",children:[e.jsxs("p",{className:"text-black font-semibold font-opensans text-sm",children:["Color: ",e.jsx("span",{className:"font-normal",children:s.color})]}),e.jsx("hr",{className:"text-customOrange opacity-40   "}),e.jsxs("p",{className:"text-black font-opensans font-semibold text-sm",children:["Size: ",e.jsxs("span",{className:"font-normal",children:[s.size," "]})]}),e.jsx("hr",{className:"text-customOrange opacity-40   "}),pe?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-customOrange text-sm",children:"Stock Quantity"}),e.jsx("input",{type:"number",className:"border no-spinner p-1 ml-2 rounded-[10px] focus:outline-customOrange",value:(null==(t=fe[s.subProductId])?void 0:t.quantity)||"",onChange:e=>{e.target.value>=0?cs("quantity",s.subProductId,e.target.value):P.error("Please enter a non-negative value.")}})]}):e.jsxs("p",{className:"font-semibold text-sm "+(0===s.stock?"text-red-500":"text-black"),children:["Quantity:"," ",e.jsx("span",{className:"font-normal",children:s.stock})]})]})]},s.subProductId)}))}),j&&e.jsx("div",{className:"px-3 my-4 flex flex-col justify-between space-y-3",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"text-black font-opensans text-sm font-bold",children:"Unpublish/Publish Product"}),e.jsx(te,{itemId:j.id,initialIsOn:ve,vendorId:m,name:j.name})]})}),e.jsx("div",{className:"mt-10",children:pe?e.jsxs("div",{className:"flex",children:[e.jsx(Z.button,{onClick:async()=>{ye(!0);try{const e=j.variants||[],s=j.subProducts||[],t=i(o,"products",j.id),n=e.map((e=>{var s;const t=`${e.color}-${e.size}`,n=parseInt(null==(s=fe[t])?void 0:s.quantity,10);return isNaN(n)?e:{...e,stock:n}})),a=s.map((e=>{var s;const t=parseInt(null==(s=fe[e.subProductId])?void 0:s.quantity,10);return isNaN(t)?e:{...e,stock:t}})),c=n.reduce(((e,s)=>e+(s.stock||0)),0)+a.reduce(((e,s)=>e+(s.stock||0)),0);await l(t,{variants:n,subProducts:a,stockQuantity:c}),P.success("Product restocked successfully."),await as("Restocked Product 🔄",`You restocked ${j.name}! Customers can now buy more of this product from your store.`,"Product Update"),he(!1),be({})}catch(e){P.error("Error restocking product: "+e.message)}finally{ye(!1)}},whileTap:{scale:1.1},className:`flex glow-button justify-center items-center w-full h-12 mt-7 bg-customOrange text-white font-semibold rounded-full ${!os()&&"opacity-25"}`,disabled:!os(),children:je?e.jsx(M,{strokeColor:"white",strokeWidth:"5",animationDuration:"0.75",width:"20",visible:!0}):"Submit Restock"}),e.jsx(Z.button,{whileTap:{scale:1.1},onClick:is,className:"glow-button w-full h-12 mt-7 ml-4 font-opensans bg-customSoftGray font-semibold rounded-full text-customRichBrown border border-customRichBrown",children:"Cancel"})]}):e.jsx(Z.button,{whileTap:{scale:1.1},onClick:is,className:"glow-button w-full h-12  mt-7 bg-customOrange text-white font-opensans font-semibold rounded-full",children:"Restock Item"})})]})}),j&&Se&&e.jsx(ne,{isOpen:Se,onRequestClose:()=>{Oe(!1)},product:j}),K&&e.jsx(E,{isOpen:K,onClose:Ke,children:e.jsx(U,{vendorId:m,closeModal:Ke,onProductAdded:()=>Ye(m)})}),le&&e.jsx(ee,{isOpen:le,onClose:()=>re(!1),onConfirm:async()=>{ue(!0);try{const e=i(o,"products",j.id);let s=j.discount.initialPrice;"personal-freebies"!==j.discount.discountType?await l(e,{price:s,discount:null,discountId:null}).then(t((e=>e.map((e=>e.id===j.id?{...e,price:s,discount:null,discountId:null}:e))))):await l(e,{discount:null,discountId:null}).then(t((e=>e.map((e=>e.id===j.id?{...e,discount:null,discountId:null}:e))))),await as("Discount Disabled ❌",`You've disabled the discount on ${j.name}. Customers can now only buy this at the original price.`,"Product Update"),P.success("Discount disabled successfully."),ue(!1),Ge()}catch(e){P.error("Error disabling discount: "+e.message),ue(!1)}re(!1),ue(!1)},message:"Are you sure you want to disable this discount?",title:"Disable Product Discount",loading:de}),oe&&("delete"===me?e.jsx(ee,{isOpen:oe,onClose:()=>ce(!1),onConfirm:async()=>{Ne(!0);try{const e=j.id;await l(i(o,"products",e),{isDeleted:!0,published:!1});const n=i(o,"vendors",m);await l(n,{productIds:O(e)}),await as("Deleted Product 🗑",`You removed ${j.name} from your store! This product no longer exists in your store and customers that have it in their carts will be notified.`,"Product Update"),t(s.filter((e=>e.id!==j.id))),P.success("Product deleted successfully."),Ke()}catch(e){P.error("Error deleting product: "+e.message)}finally{Ne(!1),xe(""),ce(!1),Ye(m)}},message:"Are you sure you want to delete this product?",icon:e.jsx(V,{className:"w-4 h-4"}),title:"Delete Product",loading:ge}):"bulkDelete"===me?e.jsx(ee,{isOpen:oe,onClose:()=>ce(!1),onConfirm:async()=>{Ne(!0);const e=i(o,"vendors",m);try{for(const s of Ie){const t=i(o,"products",s);await l(t,{published:!1,isDeleted:!0}),await l(e,{productIds:O(s)})}P.success("Selected products deleted successfully."),Re([]),Me((e=>!e)),Qe(!1),Ue(null),Pe(!1),ce(!1),xe(""),await as("Deleted Products 🗑","You removed products from your store! These products no longer exist in your store and customers that have them in their carts will be notified.","Product Update")}catch(s){P.error("Error deleting products: "+s.message)}finally{Ne(!1)}},message:"Are you sure you want to delete these products?",icon:e.jsx(V,{className:"w-4 h-4"}),title:"Delete Products",loading:ge}):"publish"===me?e.jsx(ee,{isOpen:oe,onClose:()=>ce(!1),onConfirm:Je,message:"Are you sure you want to publish these products?",icon:e.jsx($,{className:"w-4 h-4"}),title:"Publish Products",loading:ge}):"unpublish"===me?e.jsx(ee,{isOpen:oe,onClose:()=>ce(!1),onConfirm:Je,message:"Are you sure you want to unpublish these products?",icon:e.jsx(B,{className:"w-4 h-4"}),title:"Unpublish Products",loading:ge}):"removeDiscount"===me?e.jsx(ee,{isOpen:oe,onClose:()=>ce(!1),onConfirm:async()=>{if(0===Ie.length)return;Ne(!0);const e=[];try{for(const s of Ie){const t=i(o,"products",s),n=await F(t);if(!n.exists())continue;const a=n.data(),c=a.discount,r=null==c?void 0:c.initialPrice;"personal-freebies"!==(null==c?void 0:c.discountType)?(await l(t,{price:r,discount:null,discountId:null}),e.push({...a,id:s,price:r,discount:null,discountId:null})):(await l(t,{discount:null,discountId:null}),e.push({...a,id:s,discount:null,discountId:null}))}await as("Discounts Disabled ❌","You've disabled the discount on some products. Customers can now only buy them at their original prices.","Product Update"),P.success("Discounts removed from selected product(s)."),Re([]),xe(""),Me((e=>!e)),Qe(!1),Ue(null),Pe(!1),ce(!1)}catch(s){P.error("Error in bulk discount removal: "+s.message)}finally{Ne(!1)}},message:"Are you sure you want to remove discount from the selected product(s)?",icon:e.jsx(J,{className:"w-4 h-4"}),title:"Remove Discount",loading:ge}):null),"addDiscount"===me&&e.jsx(ae,{isOpen:Fe,onRequestClose:()=>{Te(!1),xe("")},product:Ie})]})};export{ie as default};
