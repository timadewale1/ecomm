import{r as e,bc as t,ad as n,j as s,G as r,_ as o,w as i,D as a,H as l,O as c,E as u,I as d,U as p,bQ as m,e as f,h,b_ as b,a9 as x,as as v,a1 as g,a5 as y,W as w,s as j,ae as S,c8 as N,a6 as k,a7 as O,a8 as P,Q as E,aS as C}from"./index-B6_tP4YQ.js";import{g as I}from"./index-C-KPEfQB.js";import{M as R}from"./index-c29tLOqg.js";import{M as T}from"./index-BZTi0IwX.js";import{g as M}from"./index-BRiOgcip.js";import{d as D}from"./index-Czi2OGzl.js";import{r as z}from"./index-Bx5UHif0.js";import{r as _}from"./index-BaqZIR9i.js";import{$ as A}from"./module-rdBSHQ9l.js";import{a as L}from"./index-DfGOTzdC.js";import{_ as W,m as F,d as B,a as U,b as V,S as H}from"./react-select.esm-RpmWxz1_.js";import{_ as $}from"./setPrototypeOf-CeEI3KLI.js";import{_ as q}from"./inheritsLoose-HiINKdoJ.js";import{a as K,T as Y}from"./Transition-EapTcxBc.js";import{a as X}from"./index-DPVG87FS.js";import{B as Q}from"./index-Bo5izuxS.js";import{T as G}from"./index-C-2PV_nF.js";import{a as J,b as Z}from"./index-AmrmWShL.js";import{a as ee,p as te}from"./producttype-CB1j3xpa.js";function ne(t,n){var s=Object.create(null);return t&&e.Children.map(t,(function(e){return e})).forEach((function(t){s[t.key]=function(t){return n&&e.isValidElement(t)?n(t):t}(t)})),s}function se(e,t,n){return null!=n[t]?n[t]:e.props[t]}function re(t,n,s){var r=ne(t.children),o=function(e,t){function n(n){return n in t?t[n]:e[n]}e=e||{},t=t||{};var s,r=Object.create(null),o=[];for(var i in e)i in t?o.length&&(r[i]=o,o=[]):o.push(i);var a={};for(var l in t){if(r[l])for(s=0;s<r[l].length;s++){var c=r[l][s];a[r[l][s]]=n(c)}a[l]=n(l)}for(s=0;s<o.length;s++)a[o[s]]=n(o[s]);return a}(n,r);return Object.keys(o).forEach((function(i){var a=o[i];if(e.isValidElement(a)){var l=i in n,c=i in r,u=n[i],d=e.isValidElement(u)&&!u.props.in;!c||l&&!d?c||!l||d?c&&l&&e.isValidElement(u)&&(o[i]=e.cloneElement(a,{onExited:s.bind(null,a),in:u.props.in,exit:se(a,"exit",t),enter:se(a,"enter",t)})):o[i]=e.cloneElement(a,{in:!1}):o[i]=e.cloneElement(a,{onExited:s.bind(null,a),in:!0,exit:se(a,"exit",t),enter:se(a,"enter",t)})}})),o}var oe=Object.values||function(e){return Object.keys(e).map((function(t){return e[t]}))},ie=function(s){function r(e,t){var n,r=(n=s.call(this,e,t)||this).handleExited.bind(W(n));return n.state={contextValue:{isMounting:!0},handleExited:r,firstRender:!0},n}q(r,s);var o=r.prototype;return o.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},o.componentWillUnmount=function(){this.mounted=!1},r.getDerivedStateFromProps=function(t,n){var s,r,o=n.children,i=n.handleExited;return{children:n.firstRender?(s=t,r=i,ne(s.children,(function(t){return e.cloneElement(t,{onExited:r.bind(null,t),in:!0,appear:se(t,"appear",s),enter:se(t,"enter",s),exit:se(t,"exit",s)})}))):re(t,o,i),firstRender:!1}},o.handleExited=function(e,n){var s=ne(this.props.children);e.key in s||(e.props.onExited&&e.props.onExited(n),this.mounted&&this.setState((function(n){var s=t({},n.children);return delete s[e.key],{children:s}})))},o.render=function(){var e=this.props,t=e.component,s=e.childFactory,r=$(e,["component","childFactory"]),o=this.state.contextValue,i=oe(this.state.children).map(s);return delete r.appear,delete r.enter,delete r.exit,null===t?n.createElement(K.Provider,{value:o},i):n.createElement(K.Provider,{value:o},n.createElement(t,r,i))},r}(n.Component);ie.propTypes={},ie.defaultProps={component:"div",childFactory:function(e){return e}};const ae=({isOpen:t,onClose:n,children:o})=>{const i=e.useRef(null);return e.useEffect((()=>{t&&I.fromTo(i.current,{opacity:0,y:810},{opacity:1,y:0,duration:1,ease:"power2.out"})}),[t]),t?s.jsx("div",{className:"fixed inset-0 flex rounded-t-lg flex-col items-center justify-center w-full bg-gray-300 bg-opacity-70 modal",children:s.jsxs("div",{ref:i,className:"bg-white rounded-t-lg mx-1 px-2 py-4 flex flex-col items-center w-full md:w-3/4 lg:w-1/2 max-h-screen overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between w-full mb-2",children:[s.jsx(r,{className:"text-3xl cursor-pointer",onClick:n}),s.jsx("h2",{className:"text-xl font-opensans text-center font-semibold text-black",children:"Add Product"}),s.jsx("div",{className:"w-3 h-3"})]}),s.jsx("div",{className:"w-full p-2",children:o})]})}):null};R.setAppElement("#root");const le=({isOpen:t,onRequestClose:n,handleSaveDiscount:r})=>{const[p,m]=e.useState([]),[f,h]=e.useState(null),[b,x]=e.useState(""),[v,g]=e.useState(""),[y,w]=e.useState(""),[j,S]=e.useState(""),[N,k]=e.useState(""),[O,P]=e.useState(!1),[E,C]=e.useState("monetary"),[I,z]=e.useState(!1),[_,A]=e.useState(""),[L,W]=e.useState(!1),F=()=>W(!1);e.useEffect((()=>{(async()=>{try{const e=a(l(c,"inAppDiscounts"),u("isActive","==",!0)),t=await d(e),n=[];t.forEach((e=>{n.push({id:e.id,...e.data()})})),n.push({id:"personal",name:"Run Personal Discount"}),m(n),n.length>0&&(h(n[0]),k(`inApp-${n[0].id}`))}catch(e){}})()}),[]),e.useEffect((()=>{const e=parseFloat(b),t=parseFloat(v);if(!isNaN(e)&&!isNaN(t)&&e>0&&t<e){const n=e-t,s=Math.round(n/e*100);w(n.toFixed(2)),S(s)}else w(""),S("")}),[b,v]);const B=e=>(e.replace(/\D/g,"")/100).toFixed(2),U=N.startsWith("inApp")||"personal-monetary"===N,V="personal-freebies"===N;let H="";U?""===b.trim()?H="Initial price is required.":""===v.trim()?H="Discount price is required.":parseFloat(v)<300?H="Discount price must be at least 300.":parseFloat(v)>=parseFloat(b)&&(H="Discount price must be less than the initial price."):V&&""===_.trim()&&(H="Freebie details are required.");const $=""===H;return s.jsxs(s.Fragment,{children:[s.jsxs(R,{isOpen:t,onRequestClose:n,className:"discount-modal",overlayClassName:"modal-overlay",children:[s.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 px-2 py-2",children:[s.jsxs("span",{className:"flex items-center",children:[s.jsx("h2",{className:"font-opensans text-lg text-customRichBrown font-semibold",children:f&&"personal"!==f.id?"In‑App Discount":"Personal Discount"}),s.jsx(M,{className:"text-customOrange text-xl ml-2"})]}),s.jsx(T,{className:"text-black text-xl cursor-pointer",onClick:n})]}),s.jsxs("div",{className:"py-4 px-2 overflow-y-auto max-h-[90vh]",children:[s.jsxs("div",{className:"relative",children:[s.jsx("label",{className:"block text-sm font-medium font-opensans text-customRichBrown",children:"Select a Discount Option"}),s.jsx("button",{className:"bg-white w-full text-left text-sm font-opensans border-gray-100 border-2 px-4 py-2 rounded-lg",onClick:()=>P(!O),children:f?f.name:"Select Discount"}),O&&s.jsx("div",{className:"absolute z-50 bg-white w-full rounded-lg shadow-lg ring-1 ring-black ring-opacity-5 mt-2 p-3",children:p.map((e=>s.jsxs("button",{onClick:()=>{h(e),P(!1),"personal"!==e.id?k(`inApp-${e.id}`):k("personal-monetary")},className:"block w-full text-left text-sm text-black font-opensans px-2 py-1 hover:bg-gray-100 rounded-md",children:[e.name," ",e.startDate&&e.endDate?`(Valid from ${new Date(1e3*e.startDate.seconds).toDateString()} to ${new Date(1e3*e.endDate.seconds).toDateString()})`:""]},e.id)))})]}),f&&"personal"===f.id&&s.jsxs("div",{className:"relative mt-4 flex flex-col ",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("label",{className:"block text-sm font-medium font-opensans text-customRichBrown",children:"Select Personal Discount Type"}),s.jsx("button",{className:"ml-2",onClick:()=>W(!0),children:s.jsx(D,{className:"w-5 h-5 text-customRichBrown"})})]}),s.jsxs("div",{className:"w-full",children:[s.jsx("button",{className:"bg-white w-full text-left text-sm font-opensans border-gray-100 border-2 px-4 py-2 rounded-lg mt-2",onClick:()=>z(!I),children:"monetary"===E?"Monetary":"Freebies"}),I&&s.jsxs("div",{className:"absolute z-50 bg-white w-full rounded-lg shadow-lg ring-1 ring-black ring-opacity-5 mt-2 p-3",children:[s.jsx("button",{onClick:()=>{C("monetary"),z(!1),k("personal-monetary")},className:"block w-full text-left text-sm text-black font-opensans px-2 py-1 hover:bg-gray-100 rounded-md",children:"Monetary"}),s.jsx("button",{onClick:()=>{C("freebies"),z(!1),k("personal-freebies")},className:"block w-full text-left text-sm text-black font-opensans px-2 py-1 hover:bg-gray-100 rounded-md",children:"Freebies"})]})]})]}),(f&&"personal"!==f.id||f&&"personal"===f.id&&"monetary"===E)&&s.jsxs("div",{className:"mt-4",children:[s.jsx("label",{className:"block text-sm font-medium font-opensans text-customRichBrown",children:"Initial Price"}),s.jsx("input",{type:"text",value:b,onChange:e=>x(B(e.target.value)),className:"w-full text-right border-2 font-opensans text-gray-800 border-gray-100 rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-customOrange",placeholder:"0.00"}),s.jsx("label",{className:"block text-sm font-medium font-opensans text-customRichBrown mt-4",children:"Discount Price"}),s.jsx("input",{type:"text",value:v,onChange:e=>g(B(e.target.value)),onBlur:()=>{parseFloat(v)<300&&(o.error("Discount price must be at least 300"),g(""))},className:"w-full text-right border-2 font-opensans text-gray-800 border-gray-100 rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-customOrange",placeholder:"0.00"}),s.jsxs("div",{className:"mt-4 flex gap-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{className:"block text-sm font-medium font-opensans text-customRichBrown",children:"Subtractive Value"}),s.jsxs("div",{className:"w-full border-2 rounded-md px-2 py-2 bg-gray-50 font-opensans font-medium text-black text-sm border-gray-100 text-right",children:["₦",y]})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{className:"block text-sm font-medium font-opensans text-customRichBrown",children:"Percentage Cut"}),s.jsxs("div",{className:"w-full border-2 rounded-md px-2 py-2 bg-gray-50 font-opensans font-medium text-black text-sm border-gray-100 text-right",children:[j,"%"]})]})]})]}),f&&"personal"===f.id&&"freebies"===E&&s.jsxs("div",{className:"mt-4",children:[s.jsx("label",{className:"block text-sm font-medium font-opensans text-customRichBrown",children:"Freebie Details"}),s.jsx("input",{type:"text",value:_,onChange:e=>A(e.target.value),className:"w-full border-2 font-opensans text-gray-800 border-gray-100 rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-customOrange",placeholder:"Enter details (e.g., Buy 1 Get 1 Free, Free Delivery)"})]}),!$&&s.jsx("div",{className:"mt-4",children:s.jsx("p",{className:"text-sm font-opensans text-red-600",children:H})}),s.jsx("div",{className:"flex justify-center mt-6",children:s.jsx("button",{onClick:()=>{let e;f&&"personal"!==f.id?e={discountType:`inApp-${f.id}`,selectedDiscount:f,initialPrice:parseFloat(b),discountPrice:parseFloat(v),subtractiveValue:parseFloat(y),percentageCut:parseFloat(j)}:f&&"personal"===f.id&&("monetary"===E?e={discountType:"personal-monetary",initialPrice:parseFloat(b),discountPrice:parseFloat(v),subtractiveValue:parseFloat(y),percentageCut:parseFloat(j)}:"freebies"===E&&(e={discountType:"personal-freebies",freebieText:_})),r(e),n()},disabled:!$,className:"w-full px-4 py-3 rounded-full font-opensans font-medium text-sm "+($?"bg-customOrange text-white hover:bg-orange-700":"bg-gray-400 text-gray-200 cursor-not-allowed"),children:"Save Discount"})})]})]}),s.jsxs(R,{isOpen:L,onRequestClose:F,className:"modal-content-rider h-auto",overlayClassName:"modal-overlay backdrop-blur-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-7 h-7 bg-blue-100 flex justify-center items-center rounded-full",children:s.jsx(i,{className:"text-customRichBrown"})}),s.jsx("h2",{className:"font-opensans text-base font-semibold",children:"Personal Discount Details"})]}),s.jsx(T,{className:"text-xl relative -top-2",onClick:F})]}),s.jsxs("div",{className:"space-y-3 mb-4",children:[s.jsx("p",{className:"text-xs font-opensans text-black font-medium",children:"Monetary Discount:"}),s.jsx("p",{className:"text-xs font-opensans text-black",children:"With a Monetary Discount, you set an initial price and a discounted price. The system calculates the amount off and the percentage reduction (displayed as a whole number). Ensure that the discount price is at least 300 and less than the initial price."}),s.jsx("p",{className:"text-xs font-opensans text-black font-medium mt-2",children:"Freebies Discount:"}),s.jsx("p",{className:"text-xs font-opensans text-black",children:'When choosing Freebies, no price reduction is applied. Instead, you provide details of the free offer (e.g., "Buy 1 Get 1 Free" or "Free Delivery"). This option is ideal if you wish to offer an incentive without changing the product price.'})]}),s.jsx("div",{className:"flex justify-end mt-2",children:s.jsx("button",{onClick:F,className:"bg-customOrange text-white font-opensans py-2 px-12 rounded-full flex items-center",children:"Close"})})]})]})};var ce,ue,de={},pe={},me={},fe={};function he(){return ce||(ce=1,function(e,t,n){Object.defineProperty(e,"__esModule",{value:!0}),e.setHasSupportToCaptureOption=m;var s=o(t),r=o(n);function o(e){return e&&e.__esModule?e:{default:e}}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e};function a(e,t){var n={};for(var s in e)t.indexOf(s)>=0||Object.prototype.hasOwnProperty.call(e,s)&&(n[s]=e[s]);return n}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}();function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var p=!1;function m(e){p=e}try{addEventListener("test",null,Object.defineProperty({},"capture",{get:function(){m(!0)}}))}catch(x){}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{capture:!0};return p?e:e.capture}function h(e){if("touches"in e){var t=e.touches[0];return{x:t.pageX,y:t.pageY}}return{x:e.screenX,y:e.screenY}}var b=function(e){function t(){var e;l(this,t);for(var n=arguments.length,s=Array(n),r=0;r<n;r++)s[r]=arguments[r];var o=u(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s)));return o._handleSwipeStart=o._handleSwipeStart.bind(o),o._handleSwipeMove=o._handleSwipeMove.bind(o),o._handleSwipeEnd=o._handleSwipeEnd.bind(o),o._onMouseDown=o._onMouseDown.bind(o),o._onMouseMove=o._onMouseMove.bind(o),o._onMouseUp=o._onMouseUp.bind(o),o._setSwiperRef=o._setSwiperRef.bind(o),o}return d(t,e),c(t,[{key:"componentDidMount",value:function(){this.swiper&&this.swiper.addEventListener("touchmove",this._handleSwipeMove,f({capture:!0,passive:!1}))}},{key:"componentWillUnmount",value:function(){this.swiper&&this.swiper.removeEventListener("touchmove",this._handleSwipeMove,f({capture:!0,passive:!1}))}},{key:"_onMouseDown",value:function(e){this.props.allowMouseEvents&&(this.mouseDown=!0,document.addEventListener("mouseup",this._onMouseUp),document.addEventListener("mousemove",this._onMouseMove),this._handleSwipeStart(e))}},{key:"_onMouseMove",value:function(e){this.mouseDown&&this._handleSwipeMove(e)}},{key:"_onMouseUp",value:function(e){this.mouseDown=!1,document.removeEventListener("mouseup",this._onMouseUp),document.removeEventListener("mousemove",this._onMouseMove),this._handleSwipeEnd(e)}},{key:"_handleSwipeStart",value:function(e){var t=h(e),n=t.x,s=t.y;this.moveStart={x:n,y:s},this.props.onSwipeStart(e)}},{key:"_handleSwipeMove",value:function(e){if(this.moveStart){var t=h(e),n=t.x,s=t.y,r=n-this.moveStart.x,o=s-this.moveStart.y;this.moving=!0,this.props.onSwipeMove({x:r,y:o},e)&&e.cancelable&&e.preventDefault(),this.movePosition={deltaX:r,deltaY:o}}}},{key:"_handleSwipeEnd",value:function(e){this.props.onSwipeEnd(e);var t=this.props.tolerance;this.moving&&this.movePosition&&(this.movePosition.deltaX<-t?this.props.onSwipeLeft(1,e):this.movePosition.deltaX>t&&this.props.onSwipeRight(1,e),this.movePosition.deltaY<-t?this.props.onSwipeUp(1,e):this.movePosition.deltaY>t&&this.props.onSwipeDown(1,e)),this.moveStart=null,this.moving=!1,this.movePosition=null}},{key:"_setSwiperRef",value:function(e){this.swiper=e,this.props.innerRef(e)}},{key:"render",value:function(){var e=this.props;e.tagName;var t=e.className,n=e.style,r=e.children;e.allowMouseEvents,e.onSwipeUp,e.onSwipeDown,e.onSwipeLeft,e.onSwipeRight,e.onSwipeStart,e.onSwipeMove,e.onSwipeEnd,e.innerRef,e.tolerance;var o=a(e,["tagName","className","style","children","allowMouseEvents","onSwipeUp","onSwipeDown","onSwipeLeft","onSwipeRight","onSwipeStart","onSwipeMove","onSwipeEnd","innerRef","tolerance"]);return s.default.createElement(this.props.tagName,i({ref:this._setSwiperRef,onMouseDown:this._onMouseDown,onTouchStart:this._handleSwipeStart,onTouchEnd:this._handleSwipeEnd,className:t,style:n},o),r)}}]),t}(t.Component);b.displayName="ReactSwipe",b.propTypes={tagName:r.default.string,className:r.default.string,style:r.default.object,children:r.default.node,allowMouseEvents:r.default.bool,onSwipeUp:r.default.func,onSwipeDown:r.default.func,onSwipeLeft:r.default.func,onSwipeRight:r.default.func,onSwipeStart:r.default.func,onSwipeMove:r.default.func,onSwipeEnd:r.default.func,innerRef:r.default.func,tolerance:r.default.number.isRequired},b.defaultProps={tagName:"div",allowMouseEvents:!1,onSwipeUp:function(){},onSwipeDown:function(){},onSwipeLeft:function(){},onSwipeRight:function(){},onSwipeStart:function(){},onSwipeMove:function(){},onSwipeEnd:function(){},innerRef:function(){},tolerance:0},e.default=b}(fe,p(),z())),fe}function be(){return ue||(ue=1,function(e,t){Object.defineProperty(e,"__esModule",{value:!0});var n=s(t);function s(e){return e&&e.__esModule?e:{default:e}}e.default=n.default}(me,he())),me}var xe,ve={};function ge(){if(xe)return ve;xe=1,Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=void 0;var e,t=(e=_())&&e.__esModule?e:{default:e};var n={ROOT:function(e){return(0,t.default)(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({"carousel-root":!0},e||"",!!e))},CAROUSEL:function(e){return(0,t.default)({carousel:!0,"carousel-slider":e})},WRAPPER:function(e,n){return(0,t.default)({"thumbs-wrapper":!e,"slider-wrapper":e,"axis-horizontal":"horizontal"===n,"axis-vertical":"horizontal"!==n})},SLIDER:function(e,n){return(0,t.default)({thumbs:!e,slider:e,animated:!n})},ITEM:function(e,n,s){return(0,t.default)({thumb:!e,slide:e,selected:n,previous:s})},ARROW_PREV:function(e){return(0,t.default)({"control-arrow control-prev":!0,"control-disabled":e})},ARROW_NEXT:function(e){return(0,t.default)({"control-arrow control-next":!0,"control-disabled":e})},DOT:function(e){return(0,t.default)({dot:!0,selected:e})}};return ve.default=n,ve}var ye,we={},je={};var Se,Ne={};function ke(){if(Se)return Ne;Se=1,Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.default=void 0;return Ne.default=function(e,t,n){var s=0===e?e:e+t;return"translate3d"+("("+("horizontal"===n?[s,0,0]:[0,s,0]).join(",")+")")},Ne}var Oe,Pe,Ee={};function Ce(){if(Oe)return Ee;Oe=1,Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.default=void 0;return Ee.default=function(){return window},Ee}function Ie(){if(Pe)return we;Pe=1,Object.defineProperty(we,"__esModule",{value:!0}),we.default=void 0;var e=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==l(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=s?Object.getOwnPropertyDescriptor(e,r):null;o&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r]}n.default=e,t&&t.set(e,n);return n}(p()),t=i(ge()),n=(ye||(ye=1,Object.defineProperty(je,"__esModule",{value:!0}),je.outerWidth=void 0,je.outerWidth=function(e){var t=e.offsetWidth,n=getComputedStyle(e);return t+(parseInt(n.marginLeft)+parseInt(n.marginRight))}),je),s=i(ke()),r=i(be()),o=i(Ce());function i(e){return e&&e.__esModule?e:{default:e}}function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(){return c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},c.apply(this,arguments)}function u(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}(e.prototype,t),e}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=h(e);if(t){var r=h(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return function(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;return f(e)}(this,n)}}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var x=function(i){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(l,i);var a=m(l);function l(t){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),b(f(r=a.call(this,t)),"itemsWrapperRef",void 0),b(f(r),"itemsListRef",void 0),b(f(r),"thumbsRef",void 0),b(f(r),"setItemsWrapperRef",(function(e){r.itemsWrapperRef=e})),b(f(r),"setItemsListRef",(function(e){r.itemsListRef=e})),b(f(r),"setThumbsRef",(function(e,t){r.thumbsRef||(r.thumbsRef=[]),r.thumbsRef[t]=e})),b(f(r),"updateSizes",(function(){if(r.props.children&&r.itemsWrapperRef&&r.thumbsRef){var t=e.Children.count(r.props.children),s=r.itemsWrapperRef.clientWidth,o=r.props.thumbWidth?r.props.thumbWidth:(0,n.outerWidth)(r.thumbsRef[0]),i=Math.floor(s/o),a=i<t,l=a?t-i:0;r.setState((function(e,t){return{itemSize:o,visibleItems:i,firstItem:a?r.getFirstItem(t.selectedItem):0,lastPosition:l,showArrows:a}}))}})),b(f(r),"handleClickItem",(function(e,t,n){if(!function(e){return e.hasOwnProperty("key")}(n)||"Enter"===n.key){var s=r.props.onSelectItem;"function"==typeof s&&s(e,t)}})),b(f(r),"onSwipeStart",(function(){r.setState({swiping:!0})})),b(f(r),"onSwipeEnd",(function(){r.setState({swiping:!1})})),b(f(r),"onSwipeMove",(function(t){var n=t.x;if(!r.state.itemSize||!r.itemsWrapperRef||!r.state.visibleItems)return!1;var o=e.Children.count(r.props.children),i=-100*r.state.firstItem/r.state.visibleItems;0===i&&n>0&&(n=0),i===100*-Math.max(o-r.state.visibleItems,0)/r.state.visibleItems&&n<0&&(n=0);var a=i+100/(r.itemsWrapperRef.clientWidth/n);return r.itemsListRef&&["WebkitTransform","MozTransform","MsTransform","OTransform","transform","msTransform"].forEach((function(e){r.itemsListRef.style[e]=(0,s.default)(a,"%",r.props.axis)})),!0})),b(f(r),"slideRight",(function(e){r.moveTo(r.state.firstItem-("number"==typeof e?e:1))})),b(f(r),"slideLeft",(function(e){r.moveTo(r.state.firstItem+("number"==typeof e?e:1))})),b(f(r),"moveTo",(function(e){e=(e=e<0?0:e)>=r.state.lastPosition?r.state.lastPosition:e,r.setState({firstItem:e})})),r.state={selectedItem:t.selectedItem,swiping:!1,showArrows:!1,firstItem:0,visibleItems:0,lastPosition:0},r}return u(l,[{key:"componentDidMount",value:function(){this.setupThumbs()}},{key:"componentDidUpdate",value:function(e){this.props.selectedItem!==this.state.selectedItem&&this.setState({selectedItem:this.props.selectedItem,firstItem:this.getFirstItem(this.props.selectedItem)}),this.props.children!==e.children&&this.updateSizes()}},{key:"componentWillUnmount",value:function(){this.destroyThumbs()}},{key:"setupThumbs",value:function(){(0,o.default)().addEventListener("resize",this.updateSizes),(0,o.default)().addEventListener("DOMContentLoaded",this.updateSizes),this.updateSizes()}},{key:"destroyThumbs",value:function(){(0,o.default)().removeEventListener("resize",this.updateSizes),(0,o.default)().removeEventListener("DOMContentLoaded",this.updateSizes)}},{key:"getFirstItem",value:function(e){var t=e;return e>=this.state.lastPosition&&(t=this.state.lastPosition),e<this.state.firstItem+this.state.visibleItems&&(t=this.state.firstItem),e<this.state.firstItem&&(t=e),t}},{key:"renderItems",value:function(){var n=this;return this.props.children.map((function(s,r){var o=t.default.ITEM(!1,r===n.state.selectedItem),i={key:r,ref:function(e){return n.setThumbsRef(e,r)},className:o,onClick:n.handleClickItem.bind(n,r,n.props.children[r]),onKeyDown:n.handleClickItem.bind(n,r,n.props.children[r]),"aria-label":"".concat(n.props.labels.item," ").concat(r+1),style:{width:n.props.thumbWidth}};return e.default.createElement("li",c({},i,{role:"button",tabIndex:0}),s)}))}},{key:"render",value:function(){var n=this;if(!this.props.children)return null;var o,i=e.Children.count(this.props.children)>1,a=this.state.showArrows&&this.state.firstItem>0,l=this.state.showArrows&&this.state.firstItem<this.state.lastPosition,c=-this.state.firstItem*(this.state.itemSize||0),u=(0,s.default)(c,"px",this.props.axis),d=this.props.transitionTime+"ms";return o={WebkitTransform:u,MozTransform:u,MsTransform:u,OTransform:u,transform:u,msTransform:u,WebkitTransitionDuration:d,MozTransitionDuration:d,MsTransitionDuration:d,OTransitionDuration:d,transitionDuration:d,msTransitionDuration:d},e.default.createElement("div",{className:t.default.CAROUSEL(!1)},e.default.createElement("div",{className:t.default.WRAPPER(!1),ref:this.setItemsWrapperRef},e.default.createElement("button",{type:"button",className:t.default.ARROW_PREV(!a),onClick:function(){return n.slideRight()},"aria-label":this.props.labels.leftArrow}),i?e.default.createElement(r.default,{tagName:"ul",className:t.default.SLIDER(!1,this.state.swiping),onSwipeLeft:this.slideLeft,onSwipeRight:this.slideRight,onSwipeMove:this.onSwipeMove,onSwipeStart:this.onSwipeStart,onSwipeEnd:this.onSwipeEnd,style:o,innerRef:this.setItemsListRef,allowMouseEvents:this.props.emulateTouch},this.renderItems()):e.default.createElement("ul",{className:t.default.SLIDER(!1,this.state.swiping),ref:function(e){return n.setItemsListRef(e)},style:o},this.renderItems()),e.default.createElement("button",{type:"button",className:t.default.ARROW_NEXT(!l),onClick:function(){return n.slideLeft()},"aria-label":this.props.labels.rightArrow})))}}]),l}(e.Component);return we.default=x,b(x,"displayName","Thumbs"),b(x,"defaultProps",{axis:"horizontal",labels:{leftArrow:"previous slide / item",rightArrow:"next slide / item",item:"slide item"},selectedItem:0,thumbWidth:80,transitionTime:350}),we}var Re,Te={};var Me,De={};function ze(){if(Me)return De;Me=1,Object.defineProperty(De,"__esModule",{value:!0}),De.setPosition=De.getPosition=De.isKeyboardEvent=De.defaultStatusFormatter=De.noop=void 0;var e,t=p(),n=(e=ke())&&e.__esModule?e:{default:e};De.noop=function(){};De.defaultStatusFormatter=function(e,t){return"".concat(e," of ").concat(t)};De.isKeyboardEvent=function(e){return!!e&&e.hasOwnProperty("key")};De.getPosition=function(e,n){if(n.infiniteLoop&&++e,0===e)return 0;var s=t.Children.count(n.children);if(n.centerMode&&"horizontal"===n.axis){var r=-e*n.centerSlidePercentage,o=s-1;return e&&(e!==o||n.infiniteLoop)?r+=(100-n.centerSlidePercentage)/2:e===o&&(r+=100-n.centerSlidePercentage),r}return 100*-e};return De.setPosition=function(e,t){var s={};return["WebkitTransform","MozTransform","MsTransform","OTransform","transform","msTransform"].forEach((function(r){s[r]=(0,n.default)(e,"%",t)})),s},De}var _e,Ae,Le={};function We(){if(Ae)return pe;Ae=1,Object.defineProperty(pe,"__esModule",{value:!0}),pe.default=void 0;var e=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==u(e)&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=s?Object.getOwnPropertyDescriptor(e,r):null;o&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r]}n.default=e,t&&t.set(e,n);return n}(p()),t=l(be()),n=l(ge()),s=l(Ie()),r=l((Re||(Re=1,Object.defineProperty(Te,"__esModule",{value:!0}),Te.default=void 0,Te.default=function(){return document}),Te)),o=l(Ce()),i=ze(),a=function(){if(_e)return Le;_e=1,Object.defineProperty(Le,"__esModule",{value:!0}),Le.fadeAnimationHandler=Le.slideStopSwipingHandler=Le.slideSwipeAnimationHandler=Le.slideAnimationHandler=void 0;var e,t=p(),n=(e=ke())&&e.__esModule?e:{default:e},s=ze();function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}return Le.slideAnimationHandler=function(e,r){var i={},a=r.selectedItem,l=a,c=t.Children.count(e.children)-1;if(e.infiniteLoop&&(a<0||a>c))return l<0?e.centerMode&&e.centerSlidePercentage&&"horizontal"===e.axis?i.itemListStyle=(0,s.setPosition)(-(c+2)*e.centerSlidePercentage-(100-e.centerSlidePercentage)/2,e.axis):i.itemListStyle=(0,s.setPosition)(100*-(c+2),e.axis):l>c&&(i.itemListStyle=(0,s.setPosition)(0,e.axis)),i;var u=(0,s.getPosition)(a,e),d=(0,n.default)(u,"%",e.axis),p=e.transitionTime+"ms";return i.itemListStyle={WebkitTransform:d,msTransform:d,OTransform:d,transform:d},r.swiping||(i.itemListStyle=o(o({},i.itemListStyle),{},{WebkitTransitionDuration:p,MozTransitionDuration:p,OTransitionDuration:p,transitionDuration:p,msTransitionDuration:p})),i},Le.slideSwipeAnimationHandler=function(e,n,r,o){var i={},a="horizontal"===n.axis,l=t.Children.count(n.children),c=(0,s.getPosition)(r.selectedItem,n),u=n.infiniteLoop?(0,s.getPosition)(l-1,n)-100:(0,s.getPosition)(l-1,n),d=a?e.x:e.y,p=d;0===c&&d>0&&(p=0),c===u&&d<0&&(p=0);var m=c+100/(r.itemSize/p),f=Math.abs(d)>n.swipeScrollTolerance;return n.infiniteLoop&&f&&(0===r.selectedItem&&m>-100?m-=100*l:r.selectedItem===l-1&&m<100*-l&&(m+=100*l)),(!n.preventMovementUntilSwipeScrollTolerance||f||r.swipeMovementStarted)&&(r.swipeMovementStarted||o({swipeMovementStarted:!0}),i.itemListStyle=(0,s.setPosition)(m,n.axis)),f&&!r.cancelClick&&o({cancelClick:!0}),i},Le.slideStopSwipingHandler=function(e,t){var n=(0,s.getPosition)(t.selectedItem,e);return{itemListStyle:(0,s.setPosition)(n,e.axis)}},Le.fadeAnimationHandler=function(e,t){var n=e.transitionTime+"ms",s="ease-in-out",r={position:"absolute",display:"block",zIndex:-2,minHeight:"100%",opacity:0,top:0,right:0,left:0,bottom:0,transitionTimingFunction:s,msTransitionTimingFunction:s,MozTransitionTimingFunction:s,WebkitTransitionTimingFunction:s,OTransitionTimingFunction:s};return t.swiping||(r=o(o({},r),{},{WebkitTransitionDuration:n,MozTransitionDuration:n,OTransitionDuration:n,transitionDuration:n,msTransitionDuration:n})),{slideStyle:r,selectedStyle:o(o({},r),{},{opacity:1,position:"relative"}),prevStyle:o({},r)}},Le}();function l(e){return e&&e.__esModule?e:{default:e}}function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(){return d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},d.apply(this,arguments)}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}(e.prototype,t),e}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=g(e);if(t){var r=g(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return function(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;return v(e)}(this,n)}}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=function(l){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(u,l);var c=x(u);function u(t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),y(v(n=c.call(this,t)),"thumbsRef",void 0),y(v(n),"carouselWrapperRef",void 0),y(v(n),"listRef",void 0),y(v(n),"itemsRef",void 0),y(v(n),"timer",void 0),y(v(n),"animationHandler",void 0),y(v(n),"setThumbsRef",(function(e){n.thumbsRef=e})),y(v(n),"setCarouselWrapperRef",(function(e){n.carouselWrapperRef=e})),y(v(n),"setListRef",(function(e){n.listRef=e})),y(v(n),"setItemsRef",(function(e,t){n.itemsRef||(n.itemsRef=[]),n.itemsRef[t]=e})),y(v(n),"autoPlay",(function(){e.Children.count(n.props.children)<=1||(n.clearAutoPlay(),n.props.autoPlay&&(n.timer=setTimeout((function(){n.increment()}),n.props.interval)))})),y(v(n),"clearAutoPlay",(function(){n.timer&&clearTimeout(n.timer)})),y(v(n),"resetAutoPlay",(function(){n.clearAutoPlay(),n.autoPlay()})),y(v(n),"stopOnHover",(function(){n.setState({isMouseEntered:!0},n.clearAutoPlay)})),y(v(n),"startOnLeave",(function(){n.setState({isMouseEntered:!1},n.autoPlay)})),y(v(n),"isFocusWithinTheCarousel",(function(){return!!n.carouselWrapperRef&&!((0,r.default)().activeElement!==n.carouselWrapperRef&&!n.carouselWrapperRef.contains((0,r.default)().activeElement))})),y(v(n),"navigateWithKeyboard",(function(e){if(n.isFocusWithinTheCarousel()){var t="horizontal"===n.props.axis,s=t?37:38;(t?39:40)===e.keyCode?n.increment():s===e.keyCode&&n.decrement()}})),y(v(n),"updateSizes",(function(){if(n.state.initialized&&n.itemsRef&&0!==n.itemsRef.length){var e="horizontal"===n.props.axis,t=n.itemsRef[0];if(t){var s=e?t.clientWidth:t.clientHeight;n.setState({itemSize:s}),n.thumbsRef&&n.thumbsRef.updateSizes()}}})),y(v(n),"setMountState",(function(){n.setState({hasMount:!0}),n.updateSizes()})),y(v(n),"handleClickItem",(function(t,s){0!==e.Children.count(n.props.children)&&(n.state.cancelClick?n.setState({cancelClick:!1}):(n.props.onClickItem(t,s),t!==n.state.selectedItem&&n.setState({selectedItem:t})))})),y(v(n),"handleOnChange",(function(t,s){e.Children.count(n.props.children)<=1||n.props.onChange(t,s)})),y(v(n),"handleClickThumb",(function(e,t){n.props.onClickThumb(e,t),n.moveTo(e)})),y(v(n),"onSwipeStart",(function(e){n.setState({swiping:!0}),n.props.onSwipeStart(e)})),y(v(n),"onSwipeEnd",(function(e){n.setState({swiping:!1,cancelClick:!1,swipeMovementStarted:!1}),n.props.onSwipeEnd(e),n.clearAutoPlay(),n.state.autoPlay&&n.autoPlay()})),y(v(n),"onSwipeMove",(function(e,t){n.props.onSwipeMove(t);var s=n.props.swipeAnimationHandler(e,n.props,n.state,n.setState.bind(v(n)));return n.setState(f({},s)),!!Object.keys(s).length})),y(v(n),"decrement",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;n.moveTo(n.state.selectedItem-("number"==typeof e?e:1))})),y(v(n),"increment",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;n.moveTo(n.state.selectedItem+("number"==typeof e?e:1))})),y(v(n),"moveTo",(function(t){if("number"==typeof t){var s=e.Children.count(n.props.children)-1;t<0&&(t=n.props.infiniteLoop?s:0),t>s&&(t=n.props.infiniteLoop?0:s),n.selectItem({selectedItem:t}),n.state.autoPlay&&!1===n.state.isMouseEntered&&n.resetAutoPlay()}})),y(v(n),"onClickNext",(function(){n.increment(1)})),y(v(n),"onClickPrev",(function(){n.decrement(1)})),y(v(n),"onSwipeForward",(function(){n.increment(1),n.props.emulateTouch&&n.setState({cancelClick:!0})})),y(v(n),"onSwipeBackwards",(function(){n.decrement(1),n.props.emulateTouch&&n.setState({cancelClick:!0})})),y(v(n),"changeItem",(function(e){return function(t){(0,i.isKeyboardEvent)(t)&&"Enter"!==t.key||n.moveTo(e)}})),y(v(n),"selectItem",(function(t){n.setState(f({previousItem:n.state.selectedItem},t),(function(){n.setState(n.animationHandler(n.props,n.state))})),n.handleOnChange(t.selectedItem,e.Children.toArray(n.props.children)[t.selectedItem])})),y(v(n),"getInitialImage",(function(){var e=n.props.selectedItem,t=n.itemsRef&&n.itemsRef[e];return(t&&t.getElementsByTagName("img")||[])[0]})),y(v(n),"getVariableItemHeight",(function(e){var t=n.itemsRef&&n.itemsRef[e];if(n.state.hasMount&&t&&t.children.length){var s=t.children[0].getElementsByTagName("img")||[];if(s.length>0){var r=s[0];if(!r.complete){r.addEventListener("load",(function e(){n.forceUpdate(),r.removeEventListener("load",e)}))}}var o=(s[0]||t.children[0]).clientHeight;return o>0?o:null}return null}));var s={initialized:!1,previousItem:t.selectedItem,selectedItem:t.selectedItem,hasMount:!1,isMouseEntered:!1,autoPlay:t.autoPlay,swiping:!1,swipeMovementStarted:!1,cancelClick:!1,itemSize:1,itemListStyle:{},slideStyle:{},selectedStyle:{},prevStyle:{}};return n.animationHandler="function"==typeof t.animationHandler&&t.animationHandler||"fade"===t.animationHandler&&a.fadeAnimationHandler||a.slideAnimationHandler,n.state=f(f({},s),n.animationHandler(t,s)),n}return h(u,[{key:"componentDidMount",value:function(){this.props.children&&this.setupCarousel()}},{key:"componentDidUpdate",value:function(e,t){e.children||!this.props.children||this.state.initialized||this.setupCarousel(),!e.autoFocus&&this.props.autoFocus&&this.forceFocus(),t.swiping&&!this.state.swiping&&this.setState(f({},this.props.stopSwipingHandler(this.props,this.state))),e.selectedItem===this.props.selectedItem&&e.centerMode===this.props.centerMode||(this.updateSizes(),this.moveTo(this.props.selectedItem)),e.autoPlay!==this.props.autoPlay&&(this.props.autoPlay?this.setupAutoPlay():this.destroyAutoPlay(),this.setState({autoPlay:this.props.autoPlay}))}},{key:"componentWillUnmount",value:function(){this.destroyCarousel()}},{key:"setupCarousel",value:function(){var t=this;this.bindEvents(),this.state.autoPlay&&e.Children.count(this.props.children)>1&&this.setupAutoPlay(),this.props.autoFocus&&this.forceFocus(),this.setState({initialized:!0},(function(){var e=t.getInitialImage();e&&!e.complete?e.addEventListener("load",t.setMountState):t.setMountState()}))}},{key:"destroyCarousel",value:function(){this.state.initialized&&(this.unbindEvents(),this.destroyAutoPlay())}},{key:"setupAutoPlay",value:function(){this.autoPlay();var e=this.carouselWrapperRef;this.props.stopOnHover&&e&&(e.addEventListener("mouseenter",this.stopOnHover),e.addEventListener("mouseleave",this.startOnLeave))}},{key:"destroyAutoPlay",value:function(){this.clearAutoPlay();var e=this.carouselWrapperRef;this.props.stopOnHover&&e&&(e.removeEventListener("mouseenter",this.stopOnHover),e.removeEventListener("mouseleave",this.startOnLeave))}},{key:"bindEvents",value:function(){(0,o.default)().addEventListener("resize",this.updateSizes),(0,o.default)().addEventListener("DOMContentLoaded",this.updateSizes),this.props.useKeyboardArrows&&(0,r.default)().addEventListener("keydown",this.navigateWithKeyboard)}},{key:"unbindEvents",value:function(){(0,o.default)().removeEventListener("resize",this.updateSizes),(0,o.default)().removeEventListener("DOMContentLoaded",this.updateSizes);var e=this.getInitialImage();e&&e.removeEventListener("load",this.setMountState),this.props.useKeyboardArrows&&(0,r.default)().removeEventListener("keydown",this.navigateWithKeyboard)}},{key:"forceFocus",value:function(){var e;null===(e=this.carouselWrapperRef)||void 0===e||e.focus()}},{key:"renderItems",value:function(t){var s=this;return this.props.children?e.Children.map(this.props.children,(function(r,o){var i=o===s.state.selectedItem,a=o===s.state.previousItem,l=i&&s.state.selectedStyle||a&&s.state.prevStyle||s.state.slideStyle||{};s.props.centerMode&&"horizontal"===s.props.axis&&(l=f(f({},l),{},{minWidth:s.props.centerSlidePercentage+"%"})),s.state.swiping&&s.state.swipeMovementStarted&&(l=f(f({},l),{},{pointerEvents:"none"}));var c={ref:function(e){return s.setItemsRef(e,o)},key:"itemKey"+o+(t?"clone":""),className:n.default.ITEM(!0,o===s.state.selectedItem,o===s.state.previousItem),onClick:s.handleClickItem.bind(s,o,r),style:l};return e.default.createElement("li",c,s.props.renderItem(r,{isSelected:o===s.state.selectedItem,isPrevious:o===s.state.previousItem}))})):[]}},{key:"renderControls",value:function(){var t=this,n=this.props,s=n.showIndicators,r=n.labels,o=n.renderIndicator,i=n.children;return s?e.default.createElement("ul",{className:"control-dots"},e.Children.map(i,(function(e,n){return o&&o(t.changeItem(n),n===t.state.selectedItem,n,r.item)}))):null}},{key:"renderStatus",value:function(){return this.props.showStatus?e.default.createElement("p",{className:"carousel-status"},this.props.statusFormatter(this.state.selectedItem+1,e.Children.count(this.props.children))):null}},{key:"renderThumbs",value:function(){return this.props.showThumbs&&this.props.children&&0!==e.Children.count(this.props.children)?e.default.createElement(s.default,{ref:this.setThumbsRef,onSelectItem:this.handleClickThumb,selectedItem:this.state.selectedItem,transitionTime:this.props.transitionTime,thumbWidth:this.props.thumbWidth,labels:this.props.labels,emulateTouch:this.props.emulateTouch},this.props.renderThumbs(this.props.children)):null}},{key:"render",value:function(){var s=this;if(!this.props.children||0===e.Children.count(this.props.children))return null;var r=this.props.swipeable&&e.Children.count(this.props.children)>1,o="horizontal"===this.props.axis,i=this.props.showArrows&&e.Children.count(this.props.children)>1,a=i&&(this.state.selectedItem>0||this.props.infiniteLoop)||!1,l=i&&(this.state.selectedItem<e.Children.count(this.props.children)-1||this.props.infiniteLoop)||!1,c=this.renderItems(!0),u=c.shift(),p=c.pop(),m={className:n.default.SLIDER(!0,this.state.swiping),onSwipeMove:this.onSwipeMove,onSwipeStart:this.onSwipeStart,onSwipeEnd:this.onSwipeEnd,style:this.state.itemListStyle,tolerance:this.props.swipeScrollTolerance},h={};if(o){if(m.onSwipeLeft=this.onSwipeForward,m.onSwipeRight=this.onSwipeBackwards,this.props.dynamicHeight){var b=this.getVariableItemHeight(this.state.selectedItem);h.height=b||"auto"}}else m.onSwipeUp="natural"===this.props.verticalSwipe?this.onSwipeBackwards:this.onSwipeForward,m.onSwipeDown="natural"===this.props.verticalSwipe?this.onSwipeForward:this.onSwipeBackwards,m.style=f(f({},m.style),{},{height:this.state.itemSize}),h.height=this.state.itemSize;return e.default.createElement("div",{"aria-label":this.props.ariaLabel,className:n.default.ROOT(this.props.className),ref:this.setCarouselWrapperRef,tabIndex:this.props.useKeyboardArrows?0:void 0},e.default.createElement("div",{className:n.default.CAROUSEL(!0),style:{width:this.props.width}},this.renderControls(),this.props.renderArrowPrev(this.onClickPrev,a,this.props.labels.leftArrow),e.default.createElement("div",{className:n.default.WRAPPER(!0,this.props.axis),style:h},r?e.default.createElement(t.default,d({tagName:"ul",innerRef:this.setListRef},m,{allowMouseEvents:this.props.emulateTouch}),this.props.infiniteLoop&&p,this.renderItems(),this.props.infiniteLoop&&u):e.default.createElement("ul",{className:n.default.SLIDER(!0,this.state.swiping),ref:function(e){return s.setListRef(e)},style:this.state.itemListStyle||{}},this.props.infiniteLoop&&p,this.renderItems(),this.props.infiniteLoop&&u)),this.props.renderArrowNext(this.onClickNext,l,this.props.labels.rightArrow),this.renderStatus()),this.renderThumbs())}}]),u}(e.default.Component);return pe.default=w,y(w,"displayName","Carousel"),y(w,"defaultProps",{ariaLabel:void 0,axis:"horizontal",centerSlidePercentage:80,interval:3e3,labels:{leftArrow:"previous slide / item",rightArrow:"next slide / item",item:"slide item"},onClickItem:i.noop,onClickThumb:i.noop,onChange:i.noop,onSwipeStart:function(){},onSwipeEnd:function(){},onSwipeMove:function(){return!1},preventMovementUntilSwipeScrollTolerance:!1,renderArrowPrev:function(t,s,r){return e.default.createElement("button",{type:"button","aria-label":r,className:n.default.ARROW_PREV(!s),onClick:t})},renderArrowNext:function(t,s,r){return e.default.createElement("button",{type:"button","aria-label":r,className:n.default.ARROW_NEXT(!s),onClick:t})},renderIndicator:function(t,s,r,o){return e.default.createElement("li",{className:n.default.DOT(s),onClick:t,onKeyDown:t,value:r,key:r,role:"button",tabIndex:0,"aria-label":"".concat(o," ").concat(r+1)})},renderItem:function(e){return e},renderThumbs:function(t){var n=e.Children.map(t,(function(t){var n=t;if("img"!==t.type&&(n=e.Children.toArray(t.props.children).find((function(e){return"img"===e.type}))),n)return n}));return 0===n.filter((function(e){return e})).length?[]:n},statusFormatter:i.defaultStatusFormatter,selectedItem:0,showArrows:!0,showIndicators:!0,showStatus:!0,showThumbs:!0,stopOnHover:!0,swipeScrollTolerance:5,swipeable:!0,transitionTime:350,verticalSwipe:"standard",width:"100%",animationHandler:"slide",swipeAnimationHandler:a.slideSwipeAnimationHandler,stopSwipingHandler:a.slideStopSwipingHandler}),pe}var Fe,Be,Ue={};Be||(Be=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"Carousel",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(e,"CarouselProps",{enumerable:!0,get:function(){return n.CarouselProps}}),Object.defineProperty(e,"Thumbs",{enumerable:!0,get:function(){return s.default}});var t=r(We()),n=(Fe||(Fe=1),Ue),s=r(Ie());function r(e){return e&&e.__esModule?e:{default:e}}}(de));var Ve=["in","onExited","appear","enter","exit"],He=function(t){return function(n){n.in,n.onExited,n.appear,n.enter,n.exit;var s=U(n,Ve);return e.createElement(t,s)}},$e=["component","duration","in","onExited"],qe=function(n){var s=n.component,r=n.duration,o=void 0===r?1:r,i=n.in;n.onExited;var a=U(n,$e),l=e.useRef(null),c={entering:{opacity:0},entered:{opacity:1,transition:"opacity ".concat(o,"ms")},exiting:{opacity:0},exited:{opacity:0}};return e.createElement(Y,{mountOnEnter:!0,unmountOnExit:!0,in:i,timeout:o,nodeRef:l},(function(n){var r={style:m({},c[n]),ref:l};return e.createElement(s,t({innerProps:r},a))}))},Ke=function(t){var n=t.children,s=t.in,r=t.onExited,o=e.useRef(null),i=e.useState("auto"),a=V(i,2),l=a[0],c=a[1];e.useEffect((function(){var e=o.current;if(e){var t=window.requestAnimationFrame((function(){return c(e.getBoundingClientRect().width)}));return function(){return window.cancelAnimationFrame(t)}}}),[]);var u=function(e){switch(e){default:return{width:l};case"exiting":return{width:0,transition:"width ".concat(260,"ms ease-out")};case"exited":return{width:0}}};return e.createElement(Y,{enter:!1,mountOnEnter:!0,unmountOnExit:!0,in:s,onExited:function(){var e=o.current;e&&(null==r||r(e))},timeout:260,nodeRef:o},(function(t){return e.createElement("div",{ref:o,style:m({overflow:"hidden",whiteSpace:"nowrap"},u(t))},n)}))},Ye=["in","onExited"],Xe=function(n){return function(s){var r=s.in,o=s.onExited,i=U(s,Ye);return e.createElement(Ke,{in:r,onExited:o},e.createElement(n,t({cropWithEllipsis:r},i)))}},Qe=function(n){return function(s){return e.createElement(qe,t({component:n,duration:s.isMulti?260:1},s))}},Ge=function(n){return function(s){return e.createElement(qe,t({component:n},s))}},Je=["component"],Ze=["children"],et=function(n){var s=n.component,r=U(n,Je),o=tt(r);return e.createElement(ie,t({component:s},o))},tt=function(t){var n=t.children,s=U(t,Ze),r=s.isMulti,o=s.hasValue,i=s.innerProps,a=s.selectProps,l=a.components,c=a.controlShouldRenderValue,u=e.useState(r&&c&&o),d=V(u,2),p=d[0],f=d[1],h=e.useState(!1),b=V(h,2),x=b[0],v=b[1];e.useEffect((function(){o&&!p&&f(!0)}),[o,p]),e.useEffect((function(){x&&!o&&p&&f(!1),v(!1)}),[x,o,p]);var g=function(){return v(!0)},y=m(m({},i),{},{style:m(m({},null==i?void 0:i.style),{},{display:r&&o||p?"flex":"grid"})});return m(m({},s),{},{innerProps:y,children:e.Children.toArray(n).map((function(t){if(r&&e.isValidElement(t)){if(t.type===l.MultiValue)return e.cloneElement(t,{onExited:g});if(t.type===l.Placeholder&&p)return null}return t}))})},nt=function(n){return function(s){return s.isMulti?e.createElement(et,t({component:n},s)):e.createElement(ie,t({component:n},s))}},st=["Input","MultiValue","Placeholder","SingleValue","ValueContainer"],rt=function(){var e=B({components:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}}),t=e.Input,n=e.MultiValue,s=e.Placeholder,r=e.SingleValue,o=e.ValueContainer,i=U(e,st);return m({Input:He(t),MultiValue:Xe(n),Placeholder:Qe(s),SingleValue:Ge(r),ValueContainer:nt(o)},i)},ot=rt();ot.Input,ot.MultiValue,ot.Placeholder,ot.SingleValue,ot.ValueContainer;var it=F(rt);const at=({availableSizes:t,addSubProduct:n,closeModal:i,initialSubProducts:a=[]})=>{const[l,c]=e.useState(a.length>0?a:[{subProductId:Math.random().toString(36).substr(2,9),images:[],size:"",color:"",stock:""}]),u=e.useRef(null),[d,p]=e.useState(0),m=(e,t,n)=>{const s=[...l];s[e][t]=n,c(s)},f=()=>{l.length>=4?o.error("You can only add up to 4 sub-products",{duration:3e3}):c([...l,{subProductId:Math.random().toString(36).substr(2,9),images:[],size:"",color:"",stock:""}])},h=()=>{const e=u.current.scrollLeft,t=u.current.offsetWidth,n=Math.round(e/t);p(n)},b=l.every((e=>e.images.length>0&&""!==e.size&&""!==e.color&&e.stock>0));return s.jsxs("div",{className:"fixed inset-0 bg-white z-50 -mx-3 overflow-y-auto flex flex-col",children:[s.jsxs("div",{className:"relative flex items-center justify-center p-4",children:[s.jsx("button",{className:"absolute left-4 text-black",onClick:i,children:s.jsx(r,{className:"h-6 w-6"})}),s.jsx("h2",{className:"text-lg font-opensans font-semibold",children:"Sub-product"})]}),s.jsx("div",{className:"p-4 flex-grow",children:l.map(((e,n)=>s.jsxs("div",{className:"mb-6 relative",children:[n>0&&s.jsx("button",{className:"absolute top-0 right-0 text-customBrown mb-2 p-2",onClick:()=>(e=>{const t=l.filter(((t,n)=>n!==e));c(t),o.dismiss(),o.success("Sub-product removed successfully",{duration:3e3})})(n),children:s.jsx(g,{className:"h-5 -translate-y-2 w-5"})}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("h3",{className:"text-md font-semibold mb-2 font-opensans text-black flex items-center",children:[s.jsx(G,{className:"w-5 h-5 mr-2 text-xl text-black"}),"Upload Image"]}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsxs("div",{ref:u,className:"relative w-full h-80 flex overflow-x-scroll snap-x snap-mandatory space-x-4",style:{scrollBehavior:"smooth"},onScroll:h,children:[e.images.length>0?e.images.map(((e,t)=>s.jsxs("div",{className:`relative flex-shrink-0 w-full h-full border-2 border-dashed border-opacity-30  border-customBrown rounded-md snap-center ${t===d?"opacity-100":"opacity-75"} transition-opacity duration-300`,children:[s.jsx("img",{src:URL.createObjectURL(e),alt:`SubProduct ${n} Image ${t+1}`,className:"w-full h-full object-cover rounded-md"}),s.jsx("button",{type:"button",className:"absolute top-2 right-2 bg-customBrown text-white rounded-full p-1",onClick:e=>{e.stopPropagation(),((e,t)=>{const n=[...l];n[e].images.splice(t,1),c(n)})(n,t)},children:s.jsx(g,{className:"h-4 w-4 text-white"})})]},t))):s.jsxs("div",{className:"w-full h-full border-2 border-dashed border-opacity-30  border-customBrown rounded-md flex items-center flex-col justify-center cursor-pointer",onClick:()=>document.getElementById(`imageUpload-${n}`).click(),children:[s.jsx(Q,{className:"h-16 w-16 text-customOrange opacity-20"}),s.jsx("h2",{className:"font-opensans px-10 text-center font-light text-xs text-customOrange opacity-90",children:"Upload product image here. Image must not be more than 3MB"})]}),s.jsx("input",{id:`imageUpload-${n}`,type:"file",accept:"image/*",onChange:e=>((e,t)=>{const n=Array.from(t.target.files),s=[...l],r=[];if(n.forEach((e=>{e.size>3145728?(o.dismiss(),o.error(`${e.name} exceeds the maximum file size of 3MB`,{duration:3e3})):r.push(e)})),r.length+s[e].images.length>2)return o.dismiss(),void o.error("You can upload a maximum of 2 images",{duration:3e3});s[e].images=[...s[e].images,...r],c(s)})(n,e),className:"hidden"})]}),e.images.length>1&&s.jsx("div",{className:"flex justify-center mt-2",children:e.images.map(((e,t)=>s.jsx("div",{className:"cursor-pointer mx-0.5 rounded-full transition-all duration-300 "+(t===d?"bg-customOrange h-2.5 w-2.5":"bg-orange-300 h-2 w-2"),onClick:()=>(e=>{p(e);const t=u.current.offsetWidth;u.current.scrollTo({left:t*e,behavior:"smooth"})})(t)},t)))}),s.jsx("div",{className:"flex justify-end mt-2 w-full",children:e.images.length<2&&s.jsxs("button",{onClick:()=>document.getElementById(`imageUpload-${n}`).click(),className:"flex items-center font-semibold justify-end text-customOrange",children:[s.jsx(J,{className:"text-xl"}),s.jsx("span",{className:"ml-1 font-opensans  text-sm",children:"Add Another Image"})]})})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"text-sm font-opensans font-medium text-black mb-1",children:"Size"}),s.jsx(H,{options:t.map((e=>({label:e,value:e}))),value:{label:e.size,value:e.size},onChange:e=>m(n,"size",e.value),className:"w-full",placeholder:"Select Product Size",isSearchable:!0})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"font-opensans font-medium mb-1 text-sm text-black",children:"Color"}),s.jsx("input",{type:"text",value:e.color,onChange:e=>m(n,"color",e.target.value),className:"w-full h-12 p-3 border-2 font-opensans text-black rounded-lg focus:outline-none focus:border-customOrange hover:border-customOrange",placeholder:""})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"font-opensans  font-medium mb-1 text-sm text-black",children:"Stock Quantity"}),s.jsx("input",{type:"number",value:e.stock,onChange:e=>m(n,"stock",e.target.value),className:"w-full h-12 p-3 border-2 font-opensans text-black rounded-lg focus:outline-none focus:border-customOrange hover:border-customOrange",placeholder:""})]}),n===l.length-1&&s.jsx("div",{className:"flex justify-end",children:s.jsxs("button",{className:"text-customOrange text-sm flex border-customBrown border rounded-full px-4 font-opensans h-12 items-center",onClick:f,children:[s.jsx(J,{className:"text-lg mr-1"}),"Add another"]})})]},n)))}),s.jsx("div",{className:"flex justify-center p-4 ",children:s.jsx("button",{className:"px-4 h-12 w-full text-white rounded-full font-opensans "+(b?"bg-customOrange":"bg-orange-200"),onClick:()=>{n(l),i()},disabled:!b,children:"Proceed"})})]})};it();const lt=({vendorId:t,closeModal:n})=>{const[r,i]=e.useState(""),[p,m]=e.useState(""),[I,M]=e.useState(""),[z,_]=e.useState(null),[W,F]=e.useState([]),[B,U]=e.useState(""),[V,$]=e.useState(""),[q,K]=e.useState(""),[Y,ne]=e.useState(""),[se,re]=e.useState(""),[oe,ie]=e.useState([]),[ae,ce]=e.useState(null),[ue,de]=e.useState(null),[pe,me]=e.useState([{color:"",sizes:[{size:"",stock:""}]}]),[fe,he]=e.useState(!1),[be,xe]=e.useState([]),[ve,ge]=e.useState(""),[ye,we]=e.useState([]),[je,Se]=e.useState(0),Ne=e.useRef(null),[ke,Oe]=e.useState(""),[Pe,Ee]=e.useState([]),[Ce,Ie]=e.useState(""),[Re,Te]=e.useState(!1),[Me,De]=e.useState(!1),[ze,_e]=e.useState(!1),[Ae,Le]=e.useState(!1),[We,Fe]=e.useState(!1),[Be,Ue]=e.useState([]),[Ve,He]=e.useState([]),[$e,qe]=e.useState([]),[Ke,Ye]=e.useState(!1),[Xe,Qe]=e.useState(!1),[Ge,Je]=e.useState(""),[Ze,et]=e.useState(""),[tt,nt]=e.useState(""),[st,rt]=e.useState(!1),[ot,it]=e.useState(""),[lt,ct]=e.useState([]),[ut,dt]=e.useState(!0),[pt,mt]=e.useState(null),[ft,ht]=e.useState(null),[bt,xt]=e.useState(!0),vt=y();R.setAppElement("#root"),e.useEffect((()=>{(async()=>{if(pt){const e=f(c,"vendors",t),n=await h(e);if(n.exists()){const e=n.data();Oe(e.shopName||"Unknown Vendor")}else Oe("Unknown Vendor")}})()}),[pt,t]),e.useEffect((()=>{}),[]),e.useEffect((()=>{Ae||qe([])}),[Ae]),e.useEffect((()=>{const e=w(),t=j(e,(e=>{e?mt(e):(mt(null),o.error("No user is signed in."))}));return()=>t()}),[]),e.useEffect((()=>{if(ae&&ue){const e=ae.value.trim(),t=ee[e];let n=[];if(Array.isArray(t))n=t;else if("object"==typeof t&&null!==t){n=t[ue.value.replace(/\s+/g,"")]||[]}if(n&&n.length>0){const e=n.map((e=>({label:e,value:e})));xe(e),Ue(n)}else xe([]),Ue([])}else xe([]),Ue([])}),[ae,ue]);e.useEffect((()=>{ft&&(ft.discountType.startsWith("inApp")||"personal-monetary"===ft.discountType)?(M(ft.discountPrice.toString()),rt(!0)):rt(!1)}),[ft]);const gt=()=>{Qe(!1)};e.useEffect((()=>{r&&Y&&ae&&ue&&pe.length&&V&&Et()}),[r,Y,ae,ue,pe,ft,V]),null==ae||ae.subTypes.map((e=>"string"==typeof e?{label:e,value:e}:{label:e.name,value:e.name}));e.useEffect((()=>{(async()=>{try{const e=l(c,"inAppDiscounts"),t=a(e,u("isActive","==",!0)),n=(await d(t)).docs.map((e=>({id:e.id,...e.data()})));ct(n)}catch(e){}finally{dt(!1)}})()}),[]);const yt=()=>{he(!1)},wt=e=>{const t=Array.from(e.target.files),n=[];t.forEach((e=>{e.size<=3145728?n.push(e):o.error(`${e.name} exceeds the maximum file size of 3MB.`)})),n.length+ye.length>4?o.error("You can only upload a maximum of 4 images."):we((e=>[...e,...n]))},jt=te.map((e=>({label:e.type,value:e.type,subTypes:e.subTypes}))),St=(e,t,n,s)=>{const r=[...pe];r[e].sizes[t][n]=s,me(r)},Nt=(e,t)=>{const n=[...pe];n[e].sizes[t].isActive=!0,me(n)},kt=e=>{Le(e),e||qe([])},Ot=()=>{Fe(!1)},Pt=async(e,n,s)=>{const r=l(c,"vendors",t,"activityNotes"),o={title:e,type:s,timestamp:new Date,note:n};try{await b(r,o)}catch(i){}},Et=async()=>{De(!0);try{const e=pe.map((e=>e.color.trim())).filter(Boolean),t=pe.flatMap((e=>e.sizes.map((e=>e.size)))).filter(Boolean),n={name:r.trim(),category:Y,productType:(null==ae?void 0:ae.value)||"",subType:(null==ue?void 0:ue.value)||"",colours:e,sizes:t,price:parseFloat(I),condition:V,discount:ft??null},{data:s}=await L.post("https://mythrift-blue-frog-1458.fly.dev/api/v1/description",n);m(s.description)}catch(e){o.error("Couldn’t generate description 😕")}finally{De(!1)}};return s.jsxs("div",{className:"relative",children:[ze&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75",children:s.jsx(A,{strokeColor:"white",strokeWidth:"5",animationDuration:"0.75",width:"96",visible:!0})}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("h3",{className:"text-md font-semibold mb-2 font-opensans text-black flex items-center",children:[s.jsx(G,{className:"w-5 h-5 mr-2 text-xl font-medium text-black"}),"Upload Image"]}),s.jsx("div",{className:"flex flex-col items-center",children:s.jsxs("div",{ref:Ne,className:"relative w-full h-80 flex overflow-x-scroll snap-x snap-mandatory space-x-4",style:{scrollBehavior:"smooth"},onScroll:()=>{const e=Ne.current.scrollLeft,t=Ne.current.offsetWidth,n=Math.round(e/t);Se(n)},children:[ye.length>0?ye.map(((e,t)=>s.jsxs("div",{className:`relative flex-shrink-0 w-full h-full border-2 border-dashed border-customBrown border-opacity-30 rounded-md snap-center ${t===je?"opacity-100":"opacity-65"} transition-opacity duration-300`,children:[s.jsx("img",{src:e instanceof File?URL.createObjectURL(e):e,alt:`Product ${t+1}`,className:"w-full h-full object-cover rounded-md"}),s.jsx("button",{type:"button",className:"absolute top-2 right-2 bg-customBrown text-white rounded-full p-1",onClick:e=>{e.stopPropagation(),(e=>{const t=ye.filter(((t,n)=>n!==e));we(t),e===je&&t.length>0&&Se(0)})(t)},children:s.jsx(g,{className:"h-4 w-4 text-white"})})]},t))):s.jsxs("div",{className:"w-full h-full border-opacity-30 border-2 border-dashed border-customBrown rounded-md flex items-center flex-col justify-center cursor-pointer",onClick:()=>document.getElementById("coverFileInput").click(),children:[s.jsx(Q,{className:"h-16 w-16 text-customOrange opacity-20"}),s.jsx("h2",{className:"font-opensans px-10 text-center font-light text-xs text-customOrange opacity-90",children:"Upload product image here. Image must not be more than 3MB"})]}),s.jsx("input",{id:"coverFileInput",type:"file",accept:"image/*",onChange:e=>wt(e),className:"hidden"})]})}),ye.length>1&&s.jsx("div",{className:"flex justify-center mt-2",children:ye.map(((e,t)=>s.jsx("div",{className:"cursor-pointer mx-0.5 rounded-full transition-all duration-300 "+(t===je?"bg-customOrange h-2.5 w-2.5":"bg-orange-300 h-2 w-2"),onClick:()=>(e=>{Se(e);const t=Ne.current.offsetWidth;Ne.current.scrollTo({left:t*e,behavior:"smooth"})})(t)},t)))}),s.jsxs("div",{className:"flex justify-end mt-2",children:[ye.length<4&&s.jsxs("button",{onClick:()=>document.getElementById("imageUpload").click(),className:"flex items-center font-semibold text-customOrange",children:[s.jsx(J,{className:"text-xl"}),s.jsx("span",{className:"ml-1 font-opensans text-sm",children:"Add Another Image"})]}),s.jsx("input",{id:"imageUpload",type:"file",accept:"image/*",onChange:wt,className:"hidden"})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"font-opensans font-medium mb-1 text-sm text-black",children:"Product Name"}),s.jsx("input",{type:"text",value:r,onChange:e=>i(e.target.value),className:"w-full h-12 p-3 border-2 font-opensans text-black rounded-lg focus:outline-none focus:border-customOrange hover:border-customOrange",required:!0})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"font-opensans font-medium mb-1 text-sm text-black",children:"Product Category"}),s.jsxs("select",{value:Y,onChange:e=>{ne(e.target.value)},className:"w-full h-12 px-4 pr-10 border border-gray-300 rounded-lg bg-white text-black font-opensans text-left appearance-none focus:outline-none focus:ring-2 focus:ring-customOrange",style:{backgroundImage:"url('data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 fill=%22%23666666%22 viewBox=%220 0 20 20%22><path d=%22M5.516 7.548l4.486 4.486 4.485-4.486a.75.75 0 01 1.06 1.06l-5.015 5.015a.75.75 0 01-1.06 0l-5.015-5.015a.75.75 0 01-1.06-1.06z%22 /></svg>')",backgroundPosition:"right 1rem center",backgroundRepeat:"no-repeat",backgroundSize:"1rem"},required:!0,children:[s.jsx("option",{value:"",children:"Select Category"}),s.jsx("option",{value:"Mens",children:"Men"}),s.jsx("option",{value:"Womens",children:"Women"}),s.jsx("option",{value:"Kids",children:"Kids"}),s.jsx("option",{value:"all",children:"All"})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"font-opensans font-medium mb-1 text-sm text-black ",children:"Product Type"}),s.jsx(H,{options:jt,value:ae,onChange:e=>{ce(e),de(null)},className:"w-full font-opensans text-sm",classNamePrefix:"custom-select",placeholder:"Select Product Type",isSearchable:!0,styles:{control:e=>({...e,height:"3rem",borderColor:"#D1D5DB",borderRadius:"0.5rem",fontFamily:"Open Sans, sans-serif",fontSize:"1rem",color:"black",paddingLeft:"0.75rem"}),input:e=>({...e,fontFamily:"Open Sans, sans-serif",fontSize:"1rem",color:"black"}),placeholder:e=>({...e,fontFamily:"Open Sans, sans-serif",fontSize:"1rem",color:"#6B7280"})}})]}),ae&&s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"font-opensans mb-1 text-sm text-black block",children:"Sub Type"}),s.jsx(H,{options:null==ae?void 0:ae.subTypes.map((e=>"string"==typeof e?{label:e,value:e}:{label:e.name,value:e.name})),value:ue,onChange:de,className:"w-full font-opensans text-sm ",classNamePrefix:"custom-select",placeholder:"Select Sub Type",isSearchable:!0,styles:{control:e=>({...e,height:"3rem",borderColor:"#D1D5DB",borderRadius:"0.5rem",fontFamily:"Open Sans, sans-serif",fontSize:"1rem",color:"black",paddingLeft:"0.75rem"}),input:e=>({...e,fontFamily:"Open Sans, sans-serif",fontSize:"1rem",color:"black"}),placeholder:e=>({...e,fontFamily:"Open Sans, sans-serif",fontSize:"1rem",color:"#6B7280"})}})]}),s.jsxs("div",{className:"mb-4",children:[pe.map(((e,t)=>s.jsxs("div",{className:"mb-4 relative",children:[s.jsx("label",{className:"block text-black mb-1 font-opensans text-sm",children:"Color"}),s.jsx("input",{type:"text",value:e.color,placeholder:" One color per variant",onChange:e=>((e,t)=>{const n=[...pe];n[e].color=t,me(n)})(t,e.target.value),className:"w-full h-12 p-3 border-2 font-opensans text-black rounded-lg focus:outline-none focus:border-customOrange hover:border-customOrange",required:!0}),e.sizes.map(((n,r)=>{const i=e.sizes.filter(((e,t)=>t!==r)).map((e=>e.size)),a=be.filter((e=>!i.includes(e.value)));return s.jsxs("div",{className:"relative mt-2",children:[r>0&&s.jsx("button",{type:"button",onClick:()=>((e,t)=>{const n=[...pe];n[e].sizes=n[e].sizes.filter(((e,n)=>n!==t)),me(n)})(t,r),className:"absolute top-0 right-0 text-customBrown",children:s.jsx(g,{})}),s.jsxs("div",{className:"flex space-x-4",children:[s.jsxs("div",{className:"flex-1 mt-2",children:[s.jsx("label",{className:"block text-black mb-1 font-opensans text-sm",children:"Size"}),s.jsx(H,{options:a,value:{label:n.size,value:n.size},onChange:n=>{St(t,r,"size",n.value),r===e.sizes.length-1&&""!==n.value&&(e=>{const t=[...pe];t[e].sizes.push({size:"",stock:"",isActive:!1}),me(t)})(t)},onFocus:()=>Nt(t,r),placeholder:"Select Size",isSearchable:!0,className:"w-full",classNamePrefix:"custom-select",styles:{control:e=>({...e,height:"3rem",borderColor:"#D1D5DB",borderRadius:"0.5rem",fontFamily:"Open Sans, sans-serif",fontSize:"1rem",color:"black",paddingLeft:"0.75rem"}),input:e=>({...e,fontFamily:"Open Sans, sans-serif",fontSize:"1rem",color:"black"}),placeholder:e=>({...e,fontFamily:"Open Sans, sans-serif",fontSize:"1rem",color:"#6B7280"})}})]}),s.jsxs("div",{className:"flex-1 mt-2",children:[s.jsx("label",{className:"block text-black mb-1 font-opensans text-sm",children:"Stock Quantity"}),s.jsx("input",{type:"number",value:n.stock,onChange:e=>{const n=e.target.value;St(t,r,"stock",n)},onBlur:e=>{parseInt(e.target.value,10)<=0&&(o.error("Stock quantity must be greater than 0."),St(t,r,"stock",""))},className:"w-full h-12 p-3 border-2 font-opensans text-black rounded-lg focus:outline-none focus:border-customOrange hover:border-customOrange "+(n.isActive?"":"bg-gray-200 cursor-pointer"),required:!0,onFocus:()=>Nt(t,r)})]})]})]},r)})),t>0&&s.jsx("button",{type:"button",onClick:()=>(e=>{me(pe.filter(((t,n)=>n!==e)))})(t),className:"absolute top-2 -translate-y-2 right-2 text-customBrown",children:s.jsx(g,{})})]},t))),s.jsx("div",{className:"mt-4 flex justify-end",children:s.jsxs("button",{type:"button",onClick:()=>{me([...pe,{color:"",sizes:[{size:"",stock:"",isActive:!0}]}])},className:"text-customOrange font-opensans text-sm flex items-center",children:[s.jsx(J,{className:"text-lg mr-1"}),"Add Another Option"]})})]}),ft?s.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg my-2 bg-gray-50 border border-customRichBrown",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"font-opensans text-sm text-customRichBrown font-semibold",children:ft.discountType.startsWith("inApp")?"In‑App Discount":"Personal Discount"}),s.jsx("span",{className:"ml-20 font-opensans text-xs px-1 text-center py-1 rounded-md font-semibold "+(ft.discountType.startsWith("inApp")||"personal-monetary"===ft.discountType?"bg-green-600 text-white":"bg-customOrange text-white"),children:ft.discountType.startsWith("inApp")||"personal-monetary"===ft.discountType?`${ft.percentageCut}% Off`:"personal-freebies"===ft.discountType?((e,t=20)=>e.length<=t?e:e.substring(0,t)+"...")(ft.freebieText):""})]}),s.jsx("button",{onClick:()=>{ht(null),Ye(!1)},title:"Remove Discount",children:s.jsx(g,{className:"text-red-600 text-lg"})})]}):s.jsxs("div",{className:"mb-2",children:[s.jsx("div",{className:"flex items-center",children:s.jsx("label",{className:"text-black font-opensans text-sm mb-1",children:"Run a discount on this product?"})}),s.jsxs("div",{className:"flex mt-2 items-center",children:[s.jsxs("label",{className:"inline-flex items-center mr-4",children:[s.jsx("input",{type:"radio",value:!1,checked:!Ke,onChange:()=>Ye(!1),className:"hidden"}),s.jsx("div",{className:"h-4 w-4 rounded-full border-2 border-customOrange flex items-center justify-center "+(Ke?"bg-white":"bg-customOrange"),children:s.jsx("div",{className:"h-2 w-2 rounded-full "+(Ke?"bg-transparent":"bg-white")})}),s.jsx("span",{className:"ml-2 font-opensans font-light text-xs text-black",children:"No"})]}),s.jsxs("label",{className:"inline-flex items-center",children:[s.jsx("input",{type:"radio",value:!0,checked:Ke,onChange:()=>{Ye(!0),Qe(!0)},className:"hidden"}),s.jsx("div",{className:"h-4 w-4 rounded-full border-2 border-customOrange flex items-center justify-center "+(Ke?"bg-customOrange":"bg-white"),children:s.jsx("div",{className:"h-2 w-2 rounded-full "+(Ke?"bg-white":"bg-transparent")})}),s.jsx("span",{className:"ml-2 font-opensans font-light text-xs text-black",children:"Yes"})]})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"font-opensans font-medium mb-1 text-sm text-black",children:"Product Price"}),s.jsx("input",{type:"text",value:I,onChange:e=>{let t=e.target.value;const n=(t.replace(/\D/g,"")/100).toFixed(2);M(n)},disabled:st,className:"w-full h-12 p-3 border-2 font-opensans text-black rounded-lg focus:outline-none focus:border-customOrange hover:border-customOrange",required:!0}),parseFloat(I)<300&&""!==I&&s.jsx("p",{className:"text-red-500 font-ubuntu text-xs mt-1",children:"Minimum product price is 300 naira."})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"font-opensans mb-1 font-medium text-sm text-black",children:"Product Condition"}),s.jsxs("select",{value:V,onChange:e=>$(e.target.value),className:"w-full h-12 px-4 pr-10 border border-gray-300 rounded-lg bg-white text-black font-opensans text-left appearance-none focus:outline-none focus:ring-2 focus:ring-customOrange",style:{backgroundImage:"url('data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 fill=%22%23666666%22 viewBox=%220 0 20 20%22><path d=%22M5.516 7.548l4.486 4.486 4.485-4.486a.75.75 0 01 1.06 1.06l-5.015 5.015a.75.75 0 01-1.06 0l-5.015-5.015a.75.75 0 01-1.06-1.06z%22 /></svg>')",backgroundPosition:"right 1rem center",backgroundRepeat:"no-repeat",backgroundSize:"1rem"},required:!0,children:[s.jsx("option",{value:"",children:"Select Condition"}),s.jsx("option",{value:"brand new",children:"Brand New"}),s.jsx("option",{value:"thrift",children:"Thrift"}),s.jsx("option",{value:"Defect:",children:"Defect"})]}),"Defect:"===V&&s.jsxs("div",{className:"mt-4",children:[s.jsx("label",{className:"block font-medium text-black text-sm font-opensans",children:"Defect Description"}),s.jsx("input",{type:"text",value:q,onChange:e=>K(e.target.value),className:"w-full h-10 px-4 pr-10 border border-gray-300 rounded-lg bg-white text-black font-opensans text-left appearance-none focus:outline-none focus:ring-2 focus:ring-customOrange",required:!0})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"mb-1 text-black font-medium font-opensans text-sm",children:"Product Description"}),s.jsxs("div",{className:"relative "+(Me?"thinking-border":""),children:[s.jsx("textarea",{value:p,onChange:e=>{e.target.value.length<=700&&m(e.target.value)},className:"mt-1 block w-full px-4 py-2 border-2 text-sm rounded-lg focus:outline-none focus:border-customOrange font-opensans hover:border-customOrange h-24 resize-none"}),s.jsxs("div",{className:"absolute bottom-2 right-2 font-opensans text-gray-500 text-xs",children:[p.length,"/700"]}),Me&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/60 backdrop-blur-sm rounded-lg z-20",children:s.jsxs("p",{className:"text-customOrange font-ubuntu text-sm animate-pulse text-center px-4",children:["Matilda is thinking…",s.jsx("br",{}),"getting the right words for you…"]})})]}),s.jsx("div",{className:"flex justify-end mt-2",children:s.jsx("button",{type:"button",onClick:Et,className:"px-2 py-2 bg-customOrange text-white rounded-md shadow-sm hover:bg-orange-700 focus:ring focus:ring-orange-600 focus:outline-none flex items-center",disabled:Me,children:Me?s.jsx(A,{strokeColor:"white",strokeWidth:"5",animationDuration:"0.75",width:"24",visible:!0}):s.jsx(X,{})})})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"font-opensans mb-1 text-sm font-medium text-black",children:"Tags"}),s.jsx("div",{className:"relative overflow-x-auto whitespace-nowrap mb-2 flex space-x-4 no-scrollbar",style:{maxWidth:"100%"},children:["Discounts","New Arrival","Cargos","Trending","Limited Edition","Jeans","Tees","Nike","Adidas","Sports"].map(((e,t)=>s.jsx("span",{onClick:()=>Ee((t=>[...t,e])),className:"bg-transparent animate-pulse border border-customOrange font-medium text-customBrown px-4 font-opensans py-1 text-xs rounded-full cursor-pointer hover:bg-orange-600 transition-all whitespace-nowrap",children:e},t)))}),s.jsxs("div",{className:"flex flex-wrap items-center border-2 border-gray-300 rounded-lg p-2",children:[Pe.map(((e,t)=>s.jsx("div",{className:"bg-gray-100 text-xs text-black font-opensans rounded-lg px-2 py-1 mr-2 mb-2",children:e},t))),s.jsx("input",{type:"text",value:Ce,onChange:e=>{const t=e.target.value;if(t.includes(",")){const e=t.replace(",","").trim();e&&!Pe.includes(e)&&Ee([...Pe,e]),Ie("")}else Ie(t)},onKeyDown:e=>{"Backspace"===e.key&&!Ce&&Pe.length>0&&(e.preventDefault(),Ee(Pe.slice(0,-1)))},placeholder:"Type tag and press comma",className:"flex-grow outline-none border-none font-opensans text-sm text-black"})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("button",{children:s.jsx(D,{onClick:()=>{he(!0)},className:"w-5 h-5 mr-2 text-lg text-customBrown"})}),s.jsx("label",{className:"text-black font-opensans text-sm mb-1",children:"Does this product have variations?"})]}),s.jsxs("div",{className:"flex mt-2 items-center",children:[s.jsxs("label",{className:"inline-flex items-center mr-4",children:[s.jsx("input",{type:"radio",value:!1,checked:!Ae,onChange:()=>kt(!1),className:"hidden"}),s.jsx("div",{className:"h-4 w-4 rounded-full border-2 border-customOrange flex items-center justify-center "+(Ae?"bg-white":"bg-customOrange"),children:s.jsx("div",{className:"h-2 w-2 rounded-full "+(Ae?"bg-transparent":"bg-white")})}),s.jsx("span",{className:"ml-2 font-opensans font-light text-xs text-black",children:"No, it doesn't"})]}),s.jsxs("label",{className:"inline-flex items-center",children:[s.jsx("input",{type:"radio",value:!0,checked:Ae,onChange:()=>kt(!0),className:"hidden"}),s.jsx("div",{className:"h-4 w-4 rounded-full border-2 border-customOrange flex items-center justify-center "+(Ae?"bg-customOrange":"bg-white"),children:s.jsx("div",{className:"h-2 w-2 rounded-full "+(Ae?"bg-white":"bg-transparent")})}),s.jsx("span",{className:"ml-2 font-opensans font-light text-xs text-black",children:"Yes, it does"})]})]}),Ae&&s.jsx("div",{className:"flex justify-end",children:s.jsxs("button",{type:"button",onClick:()=>{Fe(!0)},className:"mt-3 px-4 py-2 bg-transparent font-opensans text-sm text-customOrange rounded-full border border-customBrown flex items-center",children:[s.jsx(J,{className:"mr-2"}),"Sub-product",$e.length>0&&` (${$e.length})`]})}),s.jsxs(R,{isOpen:fe,onRequestClose:yt,className:"modal-content ",overlayClassName:"modal-overlay modals",children:[s.jsxs("div",{className:"flex items-center px-2 py-2 justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-7 h-7 bg-rose-100 flex justify-center items-center rounded-full",children:s.jsx(N,{className:"text-customRichBrown"})}),s.jsx("h2",{className:"font-opensans text-base font-semibold",children:"What are Product Variations?"})]}),s.jsx(T,{className:"text-black text-xl cursor-pointer",onClick:yt})]}),s.jsx("div",{className:"px-4 -translate-y-6",children:s.jsx("p",{className:"text-gray-600 mt-2 font-opensans text-sm",children:"Variations let you add different options like colors and sizes under one product listing, making it easy to manage similar products together. Ideal for products in the same category or type, so you don’t have to post each one separately."})})]})]}),s.jsx(le,{isOpen:Xe,onRequestClose:gt,handleSaveDiscount:e=>{ht(e),(e.discountType.startsWith("inApp")||"personal-monetary"===e.discountType)&&(M(e.discountPrice.toString()),rt(!0)),gt()}}),s.jsx("div",{className:"text-sm",children:s.jsx("button",{type:"button",onClick:async()=>{if(pt&&pt.uid===t)if(r&&I&&0!==ye.length&&V&&Y&&ae&&p)if(0!==pe.length){if("Defect:"===V&&!q)return o.dismiss(),void o.error("Please provide a defect description for the defective product.");for(const[e,t]of pe.entries()){if(!t.color)return void o.error(`Please enter a color for variant ${e+1}.`);if(0===t.sizes.length)return void o.error(`Please add at least one size for variant ${e+1}.`);for(const[n,s]of t.sizes.entries())if(!s.size||!s.stock)return void o.error(`Please enter size and stock for variant ${e+1}, size ${n+1}.`)}if(Ae){if(0===$e.length)return void o.error("Please add at least one sub-product.");for(const[e,t]of $e.entries())if(0===t.images.length||!t.size||!t.color||!t.stock)return void o.error(`Please complete all fields for sub-product ${e+1}.`)}Te(!0);try{const e=[];for(const n of ye){if(!n||!n.name){o.error("One of the images is missing a filename.");continue}const s=k(vt,`${t}/products/${r}/${n.name}`);await O(s,n);const i=await P(s);e.push(i)}const s=e[0];let g=0;const y=[];for(const t of pe){const e=t.color.trim();for(const n of t.sizes){const t=parseInt(n.stock,10);g+=t;const s={color:e,size:n.size,stock:t};y.push(s)}}const w=[];for(const n of $e){const e=[];for(const o of n.images){const s=k(vt,`${t}/products/${r}/subProducts/${n.color}_${n.size}/${o.name}`);await O(s,o);const i=await P(s);e.push(i)}g+=parseInt(n.stock,10);const s={color:n.color.trim(),size:n.size,subProductId:n.subProductId,stock:parseInt(n.stock,10),images:e};w.push(s)}const j=f(c,"vendors",t),S=await h(j);if(!S.exists())return o.error("Vendor data not found."),void Te(!1);const N=S.data(),R=N.coverImageUrl||"",T={name:r.trim(),description:p.trim(),price:parseFloat(I),coverImageUrl:s,imageUrls:e,isFeatured:!1,vendorId:pt.uid,vendorName:N.shopName,stockQuantity:g,condition:V,category:Y,productType:ae.value,subType:ue.value,createdAt:new Date,tags:Pe,variants:y,published:!0,isDeleted:!1};w.length>0&&(T.subProducts=w),ft&&(T.discount=ft),"Defect:"===V&&q&&(T.defectDescription=q.trim());const D=l(c,"products"),z=f(D);if(await E(z,T),await x(j,{productIds:C(z.id)}),ft){const e=l(c,"discounts"),n=f(e),s={vendorId:t,type:ft.discountType.startsWith("inApp")?"inApp":"personal",...ft.discountType.startsWith("personal")?{discountSubType:"personal-monetary"===ft.discountType?"monetary":"freebies"}:{},isActive:!0,createdAt:v(),..."personal-freebies"!==ft.discountType&&ft.initialPrice?{initialPrice:ft.initialPrice,discountPrice:ft.discountPrice,percentageCut:ft.percentageCut,subtractiveValue:ft.subtractiveValue}:{},..."personal-freebies"===ft.discountType?{freebieText:ft.freebieText}:{},...ft.selectedDiscount?{selectedDiscountId:ft.selectedDiscount.id,selectedDiscountName:ft.selectedDiscount.name}:{}};await E(n,s),await x(j,{discountIds:C(n.id)}),await x(z,{discountId:n.id})}ft?await Pt("Running a Discount 🎉",`You've applied a ${ft.discountType.startsWith("inApp")?"store-wide":"personal"} discount on ${r}. Check your store for more details!`,"Discount Update"):await Pt("Added New Product 📦",`You've added ${r} to your store! You can now view and feature it in your store products section.`,"Product Update"),await(async(e,t)=>{try{const n=f(c,"vendors",e),s=await h(n);if(!s.exists())return;const r=s.data(),o=r.coverImageUrl||"",i=l(c,"follows"),p=a(i,u("vendorId","==",e)),m=(await d(p)).docs.map((async n=>{const s=n.data().userId;await b(l(c,"notifications"),{userId:s,message:`New product added by ${r.shopName}: ${t.name}`,productLink:`/product/${t.id}`,productId:t.id,productImage:t.coverImageUrl||"",vendorName:r.shopName,vendorCoverImage:o,createdAt:new Date,seen:!1,type:"vendor"});const i=await h(f(c,"users",s)),p=i.exists()?i.data():null;if(!p||!p.email)return;const m=p.email,g=p.displayName||"there",y={id:t.id,name:t.name,image:t.coverImageUrl||"",price:t.price,link:`https://www.shopmythrift.store/product/${t.id}?shared=true`,createdAt:new Date},w=a(l(c,"pendingProductEmails"),u("userId","==",s),u("vendorId","==",e)),j=await d(w);if(j.empty)await b(l(c,"pendingProductEmails"),{userId:s,userEmail:m,userName:g,vendorId:e,vendorName:r.shopName,vendorCoverImage:o,products:[y],createdAt:v()});else{const e=j.docs[0].ref,t=j.docs[0].data(),n=t.products?[...t.products,y]:[y];await x(e,{products:n})}}));await Promise.all(m)}catch(n){}})(t,{name:r,shopName:N.shopName,id:z.id,price:parseFloat(I),vendorCoverImage:R,coverImageUrl:s}),o.success("Product added successfully"),i(""),m(""),M(""),we([]),$(""),K(""),ne(""),ce(null),de(null),me([{color:"",sizes:[{size:"",stock:"",isActive:!0}]}]),Ee([]),Le(!1),qe([]),ht(null),Ye(!1),n()}catch(e){o.error("Error adding product: "+e.message)}finally{Te(!1)}}else o.error("Please add at least one product variant.");else o.error("Please fill in all required fields!");else o.error("Unauthorized access or no user is signed in.")},className:"w-full px-4 h-12 font-opensans text-lg rounded-full focus:ring focus:outline-none flex items-center justify-center "+(Re||parseFloat(I)<300?"bg-gray-400 text-gray-200 cursor-not-allowed":ft?"bg-green-600 text-white hover:bg-green-700 focus:ring-green-500":"bg-customOrange text-white hover:bg-customOrange focus:ring-customOrange"),disabled:Re||parseFloat(I)<300,children:Re?s.jsx("div",{className:"flex items-center justify-center",children:s.jsx(A,{strokeColor:"white",strokeWidth:"5",animationDuration:"0.75",width:"24",visible:!0})}):s.jsxs(s.Fragment,{children:["Publish Product",ft&&s.jsx(Z,{className:"ml-2 text-lg"})]})})}),We&&S.createPortal(s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center modals",children:s.jsx("div",{className:"bg-white p-4 rounded-lg overflow-y-auto w-96 modals",children:s.jsx(at,{availableSizes:Be,addSubProduct:e=>{qe(e),Ot()},closeModal:Ot,initialSubProducts:$e})})}),document.body)]})};export{lt as A,ae as M};
