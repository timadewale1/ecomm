import{h as e,r as s,j as t,M as r,eT as n,b as a,aG as o,d as l,a as i,y as c,ac as d,ay as u,c as m,q as x,w as h,g as f}from"./index-CvIXhaMv.js";r.setAppElement("#root");const p=({isOpen:u,onClose:m,orderId:x,orderData:h})=>{const f=e(),[p,v]=s.useState("the vendor"),[y,j]=s.useState(!1),[b,w]=s.useState(""),[g,N]=s.useState("");s.useEffect((()=>{(async()=>{if(null==h?void 0:h.vendorId)try{const e=l(i,"vendors",h.vendorId),s=await c(e);if(s.exists()){const e=s.data();v(e.shopName||"the vendor")}}catch(e){}})()}),[null==h?void 0:h.vendorId]);return t.jsxs(t.Fragment,{children:[t.jsx(r,{isOpen:u,onRequestClose:m,contentLabel:"Leave a Review",style:{content:{position:"absolute",bottom:"0",left:"0",right:"0",top:"auto",borderRadius:"20px 20px 0 0",padding:"20px",backgroundColor:"#ffffff",border:"none",height:"60%",animation:"slide-up 0.3s ease-in-out"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"flex-end",justifyContent:"center",zIndex:3e3}},children:t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4 w-full",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-9 h-9 bg-rose-100 flex justify-center items-center rounded-full",children:t.jsx(n,{className:"text-customRichBrown text-2xl"})}),t.jsx("h2",{className:"font-opensans text-lg ml-4 font-semibold",children:"Leave a Review ðŸ§¡"})]}),t.jsx(a,{className:"text-black text-xl cursor-pointer",onClick:async()=>{if(x)try{const e=l(i,"orders",x);await d(e,{isReviewed:!0})}catch(e){}m()}})]}),t.jsxs("div",{className:"px-4",children:[t.jsxs("p",{className:"text-sm font-opensans text-black font-normal",children:[p," has delivered your"," ",(null==h?void 0:h.isStockpile)?"stockpile":"order"," with ID"," ",t.jsxs("strong",{children:["[",(null==h?void 0:h.isStockpile)?h.stockpileDocId:x,"]"]}),". We hope you love it! Please leave a review â€” our vendors love hearing from you.",(null==h?void 0:h.isStockpile)&&t.jsxs(t.Fragment,{children:[" ","If there are any issues with your stockpile, you can easily"," ",t.jsx("strong",{children:"dispute it"})," and our team will assist you promptly. Cheers to eco-friendly fashion!ðŸ¥³"]})]}),t.jsxs("div",{className:"mt-12 flex flex-col justify-center",children:[t.jsx("button",{onClick:async()=>{if(x){try{const e=l(i,"orders",x);await d(e,{isReviewed:!0})}catch(e){}f(`/reviews/${h.vendorId}`)}m()},className:"px-6 h-12 w-full text-sm font-opensans py-2 bg-customOrange text-white font-medium rounded-full",children:"Write a Review"}),t.jsx("button",{onClick:()=>j(!0),className:"px-6 h-12 w-full mt-4 text-sm font-opensans py-2 bg-transparent border-customRichBrown text-customRichBrown border font-medium rounded-full",children:"Dispute"})]})]})]})}),t.jsxs(r,{isOpen:y,onRequestClose:()=>j(!1),className:"modal-content-reason h-auto",overlayClassName:"modal-overlay",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-7 h-7 bg-rose-100 flex justify-center items-center rounded-full",children:t.jsx(o,{className:"text-customRichBrown"})}),t.jsx("h2",{className:"font-opensans text-base font-semibold",children:"Reason for Dispute"})]}),t.jsx(a,{className:"text-black text-xl cursor-pointer",onClick:()=>j(!1)})]}),t.jsxs("div",{className:"space-y-3 mb-4",children:[["Order hasn't been delivered","Order arrived horribly damaged","Incorrect order","Other"].map(((e,s)=>t.jsxs("div",{className:"cursor-pointer flex items-center text-gray-800 mb-1 "+(b===e?"border-customOrange":"border-gray-200"),onClick:()=>{w(e),"Other"!==e&&N("")},children:[t.jsx("div",{className:"w-5 h-5 rounded-full border-2 flex justify-center items-center mr-3 "+(b===e?"border-customOrange":"border-customOrange border-opacity-80"),children:b===e&&t.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-500"})}),t.jsx("span",{className:"font-opensans text-black",children:e})]},s))),"Other"===b&&t.jsx("input",{type:"text",placeholder:"Other reason...",className:"border px-2 h-20 text-xs rounded w-full",value:g,onChange:e=>N(e.target.value)})]}),t.jsx("div",{className:"flex justify-end mt-4",children:t.jsx("button",{onClick:async()=>{const e="Other"===b?g:b;if(!e)return void alert("Please select or enter a reason for the dispute.");if(x)try{const s=l(i,"orders",x);await d(s,{disputeOrder:!0,disputeReason:e})}catch(r){}const s=encodeURIComponent("Dispute Claim - Order Issue"),t=encodeURIComponent(`Hello Support,\n\nI have a dispute regarding my order.\nReason: ${e}\n\nPlease assist me further.\n\nThanks,`);window.location.href=`mailto:support@mythrift.store?subject=${s}&body=${t}`,j(!1),m()},className:"bg-customOrange text-white font-opensans py-2 px-12 rounded-full",children:"Send"})})]})]})},v=({children:e})=>{const{currentUser:r}=u(),[n,a]=s.useState(!1),[o,c]=s.useState(null),[v,y]=s.useState(null);s.useEffect((()=>{if(!r)return;(async()=>{try{const e=m(i,"orders"),s=x(e,h("userId","==",r.uid),h("progressStatus","==","Delivered"),h("isReviewed","==",!1)),t=await f(s),n=[];if(t.forEach((e=>{n.push({id:e.id,...e.data()})})),n.length>0){const e=n[0];c(e.id),y(e),a(!0)}}catch(e){}})()}),[r]);return t.jsxs(t.Fragment,{children:[e,t.jsx(p,{isOpen:n,onClose:async()=>{if(o)try{const e=l(i,"orders",o);await d(e,{isReviewed:!0})}catch(e){}a(!1),c(null),y(null)},orderId:o,orderData:v})]})};export{v as default};
