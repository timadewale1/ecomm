import{u as e,r as s,j as t,e as r,O as n,h as a,a9 as o,a as i,H as l,D as d,E as c,I as u}from"./index-B6_tP4YQ.js";import{M as m}from"./index-c29tLOqg.js";import{p as x,M as h,i as f}from"./index-BZTi0IwX.js";import"./index-Bx5UHif0.js";import"./warning-DM8AoHwU.js";m.setAppElement("#root");const p=({isOpen:i,onClose:l,orderId:d,orderData:c})=>{const u=e(),[p,v]=s.useState("the vendor"),[j,y]=s.useState(!1),[b,w]=s.useState(""),[g,N]=s.useState("");s.useEffect((()=>{(async()=>{if(null==c?void 0:c.vendorId)try{const e=r(n,"vendors",c.vendorId),s=await a(e);if(s.exists()){const e=s.data();v(e.shopName||"the vendor")}}catch(e){}})()}),[null==c?void 0:c.vendorId]);return t.jsxs(t.Fragment,{children:[t.jsx(m,{isOpen:i,onRequestClose:l,contentLabel:"Leave a Review",style:{content:{position:"absolute",bottom:"0",left:"0",right:"0",top:"auto",borderRadius:"20px 20px 0 0",padding:"20px",backgroundColor:"#ffffff",border:"none",height:"60%",animation:"slide-up 0.3s ease-in-out"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"flex-end",justifyContent:"center",zIndex:3e3}},children:t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4 w-full",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-9 h-9 bg-rose-100 flex justify-center items-center rounded-full",children:t.jsx(x,{className:"text-customRichBrown text-2xl"})}),t.jsx("h2",{className:"font-opensans text-lg ml-4 font-semibold",children:"Leave a Review ðŸ§¡"})]}),t.jsx(h,{className:"text-black text-xl cursor-pointer",onClick:async()=>{if(d)try{const e=r(n,"orders",d);await o(e,{isReviewed:!0})}catch(e){}l()}})]}),t.jsxs("div",{className:"px-4",children:[t.jsxs("p",{className:"text-sm font-opensans text-black font-normal",children:[p," has delivered your"," ",(null==c?void 0:c.isStockpile)?"stockpile":"order"," with ID"," ",t.jsxs("strong",{children:["[",(null==c?void 0:c.isStockpile)?c.stockpileDocId:d,"]"]}),". We hope you love it! Please leave a review â€” our vendors love hearing from you.",(null==c?void 0:c.isStockpile)&&t.jsxs(t.Fragment,{children:[" ","If there are any issues with your stockpile, you can easily"," ",t.jsx("strong",{children:"dispute it"})," and our team will assist you promptly. Cheers to eco-friendly fashion!ðŸ¥³"]})]}),t.jsxs("div",{className:"mt-12 flex flex-col justify-center",children:[t.jsx("button",{onClick:async()=>{if(d){try{const e=r(n,"orders",d);await o(e,{isReviewed:!0})}catch(e){}u(`/reviews/${c.vendorId}`)}l()},className:"px-6 h-12 w-full text-sm font-opensans py-2 bg-customOrange text-white font-medium rounded-full",children:"Write a Review"}),t.jsx("button",{onClick:()=>y(!0),className:"px-6 h-12 w-full mt-4 text-sm font-opensans py-2 bg-transparent border-customRichBrown text-customRichBrown border font-medium rounded-full",children:"Dispute"})]})]})]})}),t.jsxs(m,{isOpen:j,onRequestClose:()=>y(!1),className:"modal-content-reason h-auto",overlayClassName:"modal-overlay",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-7 h-7 bg-rose-100 flex justify-center items-center rounded-full",children:t.jsx(f,{className:"text-customRichBrown"})}),t.jsx("h2",{className:"font-opensans text-base font-semibold",children:"Reason for Dispute"})]}),t.jsx(h,{className:"text-black text-xl cursor-pointer",onClick:()=>y(!1)})]}),t.jsxs("div",{className:"space-y-3 mb-4",children:[["Order hasn't been delivered","Order arrived horribly damaged","Incorrect order","Other"].map(((e,s)=>t.jsxs("div",{className:"cursor-pointer flex items-center text-gray-800 mb-1 "+(b===e?"border-customOrange":"border-gray-200"),onClick:()=>{w(e),"Other"!==e&&N("")},children:[t.jsx("div",{className:"w-5 h-5 rounded-full border-2 flex justify-center items-center mr-3 "+(b===e?"border-customOrange":"border-customOrange border-opacity-80"),children:b===e&&t.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-500"})}),t.jsx("span",{className:"font-opensans text-black",children:e})]},s))),"Other"===b&&t.jsx("input",{type:"text",placeholder:"Other reason...",className:"border px-2 h-20 text-xs rounded w-full",value:g,onChange:e=>N(e.target.value)})]}),t.jsx("div",{className:"flex justify-end mt-4",children:t.jsx("button",{onClick:async()=>{const e="Other"===b?g:b;if(!e)return void alert("Please select or enter a reason for the dispute.");if(d)try{const s=r(n,"orders",d);await o(s,{disputeOrder:!0,disputeReason:e})}catch(a){}const s=encodeURIComponent("Dispute Claim - Order Issue"),t=encodeURIComponent(`Hello Support,\n\nI have a dispute regarding my order.\nReason: ${e}\n\nPlease assist me further.\n\nThanks,`);window.location.href=`mailto:support@mythrift.store?subject=${s}&body=${t}`,y(!1),l()},className:"bg-customOrange text-white font-opensans py-2 px-12 rounded-full",children:"Send"})})]})]})},v=({children:e})=>{const{currentUser:a}=i(),[m,x]=s.useState(!1),[h,f]=s.useState(null),[v,j]=s.useState(null);s.useEffect((()=>{if(!a)return;(async()=>{try{const e=l(n,"orders"),s=d(e,c("userId","==",a.uid),c("progressStatus","==","Delivered"),c("isReviewed","==",!1)),t=await u(s),r=[];if(t.forEach((e=>{r.push({id:e.id,...e.data()})})),r.length>0){const e=r[0];f(e.id),j(e),x(!0)}}catch(e){}})()}),[a]);return t.jsxs(t.Fragment,{children:[e,t.jsx(p,{isOpen:m,onClose:async()=>{if(h)try{const e=r(n,"orders",h);await o(e,{isReviewed:!0})}catch(e){}x(!1),f(null),j(null)},orderId:h,orderData:v})]})};export{v as default};
